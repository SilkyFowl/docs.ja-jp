---
description: '詳細情報: Delegate ステートメント'
title: Delegate ステートメント
ms.date: 07/20/2015
f1_keywords:
- vb.Delegate
helpviewer_keywords:
- delegate keyword [Visual Basic]
- Delegate statement [Visual Basic]
ms.assetid: f799c518-0817-40cc-ad0b-4da846fdba57
ms.openlocfilehash: 3fbf3d7b47b465fd0850f01170e02b19b7b93b4e
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/06/2021
ms.locfileid: "99673818"
---
# <a name="delegate-statement"></a><span data-ttu-id="e0b2c-103">Delegate ステートメント</span><span class="sxs-lookup"><span data-stu-id="e0b2c-103">Delegate Statement</span></span>

<span data-ttu-id="e0b2c-104">デリゲートの宣言に使用します。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-104">Used to declare a delegate.</span></span> <span data-ttu-id="e0b2c-105">デリゲートは、型の `Shared` メソッドまたはオブジェクトのインスタンス メソッドを参照する参照型です。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-105">A delegate is a reference type that refers to a `Shared` method of a type or to an instance method of an object.</span></span> <span data-ttu-id="e0b2c-106">パラメーターおよび戻り値の型が一致するプロシージャを使用すると、このデリゲート クラスのインスタンスを作成できます。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-106">Any procedure with matching parameter and return types can be used to create an instance of this delegate class.</span></span> <span data-ttu-id="e0b2c-107">このプロシージャは、後でデリゲート インスタンスを使用して呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-107">The procedure can then later be invoked by means of the delegate instance.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="e0b2c-108">構文</span><span class="sxs-lookup"><span data-stu-id="e0b2c-108">Syntax</span></span>  
  
```vb  
[ <attrlist> ] [ accessmodifier ] _  
[ Shadows ] Delegate [ Sub | Function ] name [( Of typeparamlist )] [([ parameterlist ])] [ As type ]  
```  
  
## <a name="parts"></a><span data-ttu-id="e0b2c-109">指定項目</span><span class="sxs-lookup"><span data-stu-id="e0b2c-109">Parts</span></span>  
  
|<span data-ttu-id="e0b2c-110">用語</span><span class="sxs-lookup"><span data-stu-id="e0b2c-110">Term</span></span>|<span data-ttu-id="e0b2c-111">定義</span><span class="sxs-lookup"><span data-stu-id="e0b2c-111">Definition</span></span>|  
|---|---|  
|`attrlist`|<span data-ttu-id="e0b2c-112">任意。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-112">Optional.</span></span> <span data-ttu-id="e0b2c-113">このデリゲートに適用される属性の一覧です。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-113">List of attributes that apply to this delegate.</span></span> <span data-ttu-id="e0b2c-114">複数の属性を指定するときは、コンマで区切ります。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-114">Multiple attributes are separated by commas.</span></span> <span data-ttu-id="e0b2c-115">[属性リスト](attribute-list.md)は山かっこ ("`<`" および "`>`") で囲む必要があります。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-115">You must enclose the [Attribute List](attribute-list.md) in angle brackets ("`<`" and "`>`").</span></span>|  
|`accessmodifier`|<span data-ttu-id="e0b2c-116">任意。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-116">Optional.</span></span> <span data-ttu-id="e0b2c-117">どのようなコードからデリゲートにアクセスできるのかを指定します。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-117">Specifies what code can access the delegate.</span></span> <span data-ttu-id="e0b2c-118">次のいずれかの値を指定します。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-118">Can be one of the following:</span></span><br /><br /> <span data-ttu-id="e0b2c-119">- [Public](../modifiers/public.md)。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-119">- [Public](../modifiers/public.md).</span></span> <span data-ttu-id="e0b2c-120">このデリゲートを宣言している要素にアクセス可能なすべてのコードからアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-120">Any code that can access the element that declares the delegate can access it.</span></span><br /><span data-ttu-id="e0b2c-121">-   [Protected](../modifiers/protected.md)。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-121">-   [Protected](../modifiers/protected.md).</span></span> <span data-ttu-id="e0b2c-122">デリゲートのクラスまたは派生クラス内のコードからのみアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-122">Only code within the delegate's class or a derived class can access it.</span></span><br /><span data-ttu-id="e0b2c-123">-   [Friend](../modifiers/friend.md)。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-123">-   [Friend](../modifiers/friend.md).</span></span> <span data-ttu-id="e0b2c-124">デリゲートには同じアセンブリ内のコードからのみアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-124">Only code within the same assembly can access the delegate.</span></span><br /><span data-ttu-id="e0b2c-125">- [Private](../modifiers/private.md)。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-125">- [Private](../modifiers/private.md).</span></span> <span data-ttu-id="e0b2c-126">このデリゲートを宣言している要素内のコードからのみアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-126">Only code within the element that declares the delegate can access it.</span></span><br /><br /> <span data-ttu-id="e0b2c-127">- [Protected Friend](../modifiers/protected-friend.md) デリゲートのクラス、派生クラス、または同じアセンブリ内のコードからのみ、デリゲートにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-127">- [Protected Friend](../modifiers/protected-friend.md) Only code within the delegate's class, a derived class, or the same assembly can access the delegate.</span></span> <br /><span data-ttu-id="e0b2c-128">- [Private Protected](../modifiers/private-protected.md) 同じアセンブリ内のデリゲートのクラスまたは派生クラス内のコードからのみ、デリゲートにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-128">- [Private Protected](../modifiers/private-protected.md) Only code within the delegate's class or in a derived class in the same assembly can access the delegate.</span></span> |  
|`Shadows`|<span data-ttu-id="e0b2c-129">任意。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-129">Optional.</span></span> <span data-ttu-id="e0b2c-130">このデリゲートが、基底クラスにある、同じ名前を持つプログラミング要素、またはオーバーロードされる要素のセットを宣言し直して非表示にすることを示します。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-130">Indicates that this delegate redeclares and hides an identically named programming element, or set of overloaded elements, in a base class.</span></span> <span data-ttu-id="e0b2c-131">宣言された要素は、他の任意の種類の要素でシャドウできます。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-131">You can shadow any kind of declared element with any other kind.</span></span><br /><br /> <span data-ttu-id="e0b2c-132">シャドウされた要素は、その要素をシャドウする派生クラスからは使用できません。ただし、シャドウする要素がアクセスできない要素の場合は例外です。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-132">A shadowed element is unavailable from within the derived class that shadows it, except from where the shadowing element is inaccessible.</span></span> <span data-ttu-id="e0b2c-133">たとえば、`Private` 要素が基底クラスの要素をシャドウすると、`Private` 要素へのアクセス許可を持たないコードが、代わりに基底クラスの要素にアクセスします。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-133">For example, if a `Private` element shadows a base class element, code that does not have permission to access the `Private` element accesses the base class element instead.</span></span>|  
|`Sub`|<span data-ttu-id="e0b2c-134">省略可能ですが、`Sub` または `Function` のいずれかを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-134">Optional, but either `Sub` or `Function` must appear.</span></span> <span data-ttu-id="e0b2c-135">このプロシージャを、値を返さないデリゲート `Sub` プロシージャとして宣言します。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-135">Declares this procedure as a delegate `Sub` procedure that does not return a value.</span></span>|  
|`Function`|<span data-ttu-id="e0b2c-136">省略可能ですが、`Sub` または `Function` のいずれかを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-136">Optional, but either `Sub` or `Function` must appear.</span></span> <span data-ttu-id="e0b2c-137">このプロシージャを、値を返すデリゲート `Function` プロシージャとして宣言します。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-137">Declares this procedure as a delegate `Function` procedure that returns a value.</span></span>|  
|`name`|<span data-ttu-id="e0b2c-138">必須です。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-138">Required.</span></span> <span data-ttu-id="e0b2c-139">デリゲート型の名前です。変数の標準的な名前付け規則に従います。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-139">Name of the delegate type; follows standard variable naming conventions.</span></span>|  
|`typeparamlist`|<span data-ttu-id="e0b2c-140">任意。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-140">Optional.</span></span> <span data-ttu-id="e0b2c-141">このデリゲートの型パラメーターのリスト。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-141">List of type parameters for this delegate.</span></span> <span data-ttu-id="e0b2c-142">複数の型パラメーターはコンマで区切ります。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-142">Multiple type parameters are separated by commas.</span></span> <span data-ttu-id="e0b2c-143">必要に応じて、`In` および `Out` ジェネリック修飾子を使用して、各型パラメーターをバリアントとして宣言できます。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-143">Optionally, each type parameter can be declared variant by using `In` and `Out` generic modifiers.</span></span> <span data-ttu-id="e0b2c-144">[型リスト](type-list.md)をかっこで囲み、`Of` キーワードと共に導入する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-144">You must enclose the [Type List](type-list.md) in parentheses and introduce it with the `Of` keyword.</span></span>|  
|`parameterlist`|<span data-ttu-id="e0b2c-145">任意。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-145">Optional.</span></span> <span data-ttu-id="e0b2c-146">呼び出されたときにプロシージャに渡されるパラメーターのリスト。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-146">List of parameters that are passed to the procedure when it is called.</span></span> <span data-ttu-id="e0b2c-147">[パラメーター リスト](parameter-list.md)はかっこで囲む必要があります。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-147">You must enclose the [Parameter List](parameter-list.md) in parentheses.</span></span>|  
|`type`|<span data-ttu-id="e0b2c-148">`Function` プロシージャを指定する場合は、必ず指定します。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-148">Required if you specify a `Function` procedure.</span></span> <span data-ttu-id="e0b2c-149">戻り値のデータ型。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-149">Data type of the return value.</span></span>|  
  
## <a name="remarks"></a><span data-ttu-id="e0b2c-150">Remarks</span><span class="sxs-lookup"><span data-stu-id="e0b2c-150">Remarks</span></span>  

 <span data-ttu-id="e0b2c-151">`Delegate` ステートメントでは、デリゲート クラスのパラメーターと戻り値の型を定義します。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-151">The `Delegate` statement defines the parameter and return types of a delegate class.</span></span> <span data-ttu-id="e0b2c-152">パラメーターおよび戻り値の型が一致するプロシージャを使用すると、このデリゲート クラスのインスタンスを作成できます。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-152">Any procedure with matching parameters and return types can be used to create an instance of this delegate class.</span></span> <span data-ttu-id="e0b2c-153">このプロシージャは、デリゲートの `Invoke` メソッドを呼び出すことによって、後でデリゲート インスタンスを使用して呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-153">The procedure can then later be invoked by means of the delegate instance, by calling the delegate's `Invoke` method.</span></span>  
  
 <span data-ttu-id="e0b2c-154">デリゲートは、名前空間、モジュール、クラス、または構造体レベルで宣言できますが、プロシージャ内では宣言できません。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-154">Delegates can be declared at the namespace, module, class, or structure level, but not within a procedure.</span></span>  
  
 <span data-ttu-id="e0b2c-155">各デリゲート クラスでは、オブジェクト メソッドの仕様を渡すコンストラクターを定義します。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-155">Each delegate class defines a constructor that is passed the specification of an object method.</span></span> <span data-ttu-id="e0b2c-156">デリゲート コンス トラクターに渡す引数は、メソッドへの参照、またはラムダ式である必要があります。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-156">An argument to a delegate constructor must be a reference to a method, or a lambda expression.</span></span>  
  
 <span data-ttu-id="e0b2c-157">メソッドへの参照を指定するには、次の構文を使用します。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-157">To specify a reference to a method, use the following syntax:</span></span>  
  
 <span data-ttu-id="e0b2c-158">`AddressOf` [`expression`.]`methodname`</span><span class="sxs-lookup"><span data-stu-id="e0b2c-158">`AddressOf` [`expression`.]`methodname`</span></span>  
  
 <span data-ttu-id="e0b2c-159">コンパイル時の `expression` の型は、シグネチャがデリゲート クラスのシグネチャと同じで、指定された名前のメソッドを持つクラスまたはインターフェイスである必要があります。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-159">The compile-time type of the `expression` must be the name of a class or an interface that contains a method of the specified name whose signature matches the signature of the delegate class.</span></span> <span data-ttu-id="e0b2c-160">`methodname` は、共有メソッドまたはインスタンス メソッドのいずれかにできます。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-160">The `methodname` can be either a shared method or an instance method.</span></span> <span data-ttu-id="e0b2c-161">クラスの既定メソッドに対してデリゲートを作成する場合も、`methodname` は省略できません。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-161">The `methodname` is not optional, even if you create a delegate for the default method of the class.</span></span>  
  
 <span data-ttu-id="e0b2c-162">ラムダ式を指定するには、次の構文を使用します。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-162">To specify a lambda expression, use the following syntax:</span></span>  
  
 <span data-ttu-id="e0b2c-163">`Function` ([`parm` As `type`, `parm2` As `type2`, ...]) `expression`</span><span class="sxs-lookup"><span data-stu-id="e0b2c-163">`Function` ([`parm` As `type`, `parm2` As `type2`, ...]) `expression`</span></span>  
  
 <span data-ttu-id="e0b2c-164">関数のシグネチャは、デリゲート型のシグネチャと一致している必要があります。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-164">The signature of the function must match that of the delegate type.</span></span> <span data-ttu-id="e0b2c-165">ラムダ式について詳しくは、「[ラムダ式](../../programming-guide/language-features/procedures/lambda-expressions.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-165">For more information about lambda expressions, see [Lambda Expressions](../../programming-guide/language-features/procedures/lambda-expressions.md).</span></span>  
  
 <span data-ttu-id="e0b2c-166">デリゲートの詳細については、「[デリゲート](../../programming-guide/language-features/delegates/index.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-166">For more information about delegates, see [Delegates](../../programming-guide/language-features/delegates/index.md).</span></span>  
  
## <a name="example"></a><span data-ttu-id="e0b2c-167">例</span><span class="sxs-lookup"><span data-stu-id="e0b2c-167">Example</span></span>  

 <span data-ttu-id="e0b2c-168">次の例では、`Delegate` ステートメントを使用して、2 つの数値を演算して 1 つの数値を返すためのデリゲートを宣言します。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-168">The following example uses the `Delegate` statement to declare a delegate for operating on two numbers and returning a number.</span></span> <span data-ttu-id="e0b2c-169">`DelegateTest` メソッドは、この型のデリゲートのインスタンスを受け取り、それを使用して数値のペアを演算します。</span><span class="sxs-lookup"><span data-stu-id="e0b2c-169">The `DelegateTest` method takes an instance of a delegate of this type and uses it to operate on pairs of numbers.</span></span>  
  
 [!code-vb[VbVbalrDelegates#14](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class1.vb#14)]  
  
## <a name="see-also"></a><span data-ttu-id="e0b2c-170">関連項目</span><span class="sxs-lookup"><span data-stu-id="e0b2c-170">See also</span></span>

- [<span data-ttu-id="e0b2c-171">AddressOf 演算子</span><span class="sxs-lookup"><span data-stu-id="e0b2c-171">AddressOf Operator</span></span>](../operators/addressof-operator.md)
- [<span data-ttu-id="e0b2c-172">Of</span><span class="sxs-lookup"><span data-stu-id="e0b2c-172">Of</span></span>](of-clause.md)
- [<span data-ttu-id="e0b2c-173">デリゲート</span><span class="sxs-lookup"><span data-stu-id="e0b2c-173">Delegates</span></span>](../../programming-guide/language-features/delegates/index.md)
- [<span data-ttu-id="e0b2c-174">方法: ジェネリック クラスを使用する</span><span class="sxs-lookup"><span data-stu-id="e0b2c-174">How to: Use a Generic Class</span></span>](../../programming-guide/language-features/data-types/how-to-use-a-generic-class.md)
- [<span data-ttu-id="e0b2c-175">Generic Types in Visual Basic</span><span class="sxs-lookup"><span data-stu-id="e0b2c-175">Generic Types in Visual Basic</span></span>](../../programming-guide/language-features/data-types/generic-types.md)
- [<span data-ttu-id="e0b2c-176">共変性と反変性</span><span class="sxs-lookup"><span data-stu-id="e0b2c-176">Covariance and Contravariance</span></span>](../../programming-guide/concepts/covariance-contravariance/index.md)
- [<span data-ttu-id="e0b2c-177">In</span><span class="sxs-lookup"><span data-stu-id="e0b2c-177">In</span></span>](../modifiers/in-generic-modifier.md)
- [<span data-ttu-id="e0b2c-178">Out</span><span class="sxs-lookup"><span data-stu-id="e0b2c-178">Out</span></span>](../modifiers/out-generic-modifier.md)
