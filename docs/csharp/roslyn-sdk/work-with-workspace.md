---
title: .NET Compiler Platform SDK ワークスペース モデルの使用
description: この概要は、コードのワークスペースとプロジェクトを照会して操作するために使用する型を理解するためのものです。
ms.date: 10/15/2017
ms.custom: mvc
ms.openlocfilehash: b613c85c01cc054dea9dd4bb9cf0062ffedb08bf
ms.sourcegitcommit: 8299abfbd5c49b596d61f1e4d09bc6b8ba055b36
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/27/2021
ms.locfileid: "98899114"
---
# <a name="work-with-a-workspace"></a><span data-ttu-id="3ceba-103">ワークスペースの使用</span><span class="sxs-lookup"><span data-stu-id="3ceba-103">Work with a workspace</span></span>

<span data-ttu-id="3ceba-104">**ワークスペース** レイヤーは、ソリューション全体でのコード分析とリファクタリングの開始点となります。</span><span class="sxs-lookup"><span data-stu-id="3ceba-104">The **Workspaces** layer is the starting point for doing code analysis and refactoring over entire solutions.</span></span> <span data-ttu-id="3ceba-105">このレイヤー内のワークスペース API では、単一のオブジェクト モデルにソリューションのプロジェクトに関するすべての情報を簡単にまとめることができ、ソース テキスト、構文ツリー、セマンティック モデル、コンパイルのようなコンパイラ レイヤー オブジェクト モデルに直接アクセスできます。ファイルの解析、オプションの構成、プロジェクト相互の依存性の管理は必要はありません。</span><span class="sxs-lookup"><span data-stu-id="3ceba-105">Within this layer, the Workspace API assists you in organizing all the information about the projects in a solution into a single object model, offering you direct access to compiler layer object models like source text, syntax trees, semantic models, and compilations without needing to parse files, configure options, or manage inter-project dependencies.</span></span>

<span data-ttu-id="3ceba-106">IDE のようなホスト環境では、開いているソリューションに応じてワークスペースが提供されます。</span><span class="sxs-lookup"><span data-stu-id="3ceba-106">Host environments, like an IDE, provide a workspace for you corresponding to the open solution.</span></span> <span data-ttu-id="3ceba-107">単にソリューション ファイルを読み込んで、IDE の外部でこのモデルを使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="3ceba-107">It is also possible to use this model outside of an IDE by simply loading a solution file.</span></span>

## <a name="workspace"></a><span data-ttu-id="3ceba-108">ワークスペース</span><span class="sxs-lookup"><span data-stu-id="3ceba-108">Workspace</span></span>

<span data-ttu-id="3ceba-109">ワークスペースは、ソリューションをプロジェクトのコレクションとしてアクティブに表現するものです。プロジェクトにはそれぞれドキュメントのコレクションが含まれます。</span><span class="sxs-lookup"><span data-stu-id="3ceba-109">A workspace is an active representation of your solution as a collection of projects, each with a collection of documents.</span></span> <span data-ttu-id="3ceba-110">通常、ワークスペースは、ユーザーがプロパティを入力または操作するときに常に変化するホスト環境に関連付けられます。</span><span class="sxs-lookup"><span data-stu-id="3ceba-110">A workspace is typically tied to a host environment that is constantly changing as a user types or manipulates properties.</span></span>

<span data-ttu-id="3ceba-111"><xref:Microsoft.CodeAnalysis.Workspace> では、ソリューションの現在のモデルにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="3ceba-111">The <xref:Microsoft.CodeAnalysis.Workspace> provides access to the current model of the solution.</span></span> <span data-ttu-id="3ceba-112">ホスト環境が変わった場合、ワークスペースは対応するイベントを発生させ、<xref:Microsoft.CodeAnalysis.Workspace.CurrentSolution?displayProperty=nameWithType> プロパティが更新されます。</span><span class="sxs-lookup"><span data-stu-id="3ceba-112">When a change in the host environment occurs, the workspace fires corresponding events, and the <xref:Microsoft.CodeAnalysis.Workspace.CurrentSolution?displayProperty=nameWithType> property is updated.</span></span> <span data-ttu-id="3ceba-113">たとえば、ソース ドキュメントのいずれかに対応するテキスト エディターにユーザーが入力した場合、ワークスペースでは、ソリューションのモデル全体が変更され、どのドキュメントが変更されたかを通知するイベントを使用します。</span><span class="sxs-lookup"><span data-stu-id="3ceba-113">For example, when the user types in a text editor corresponding to one of the source documents, the workspace uses an event to signal that the overall model of the solution has changed and which document was modified.</span></span> <span data-ttu-id="3ceba-114">したがって、新しいモデルを分析して正しいかどうかを確認したり、重要な領域を強調表示したり、あるいはコードの変更を提案することで、これらの変更に対応できます。</span><span class="sxs-lookup"><span data-stu-id="3ceba-114">You can then react to those changes by analyzing the new model for correctness, highlighting areas of significance, or making a suggestion for a code change.</span></span>

<span data-ttu-id="3ceba-115">ホスト環境から切断されているか、ホスト環境がないアプリケーションで使用されるスタンドアロンのワークスペースを作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="3ceba-115">You can also create stand-alone workspaces that are disconnected from the host environment or used in an application that has no host environment.</span></span>

## <a name="solutions-projects-and-documents"></a><span data-ttu-id="3ceba-116">ソリューション、プロジェクト、およびドキュメント</span><span class="sxs-lookup"><span data-stu-id="3ceba-116">Solutions, projects, and documents</span></span>

<span data-ttu-id="3ceba-117">キーが押されるたびにワークスペースが変更されることがありますが、ソリューションのモデルを単独で操作することができます。</span><span class="sxs-lookup"><span data-stu-id="3ceba-117">Although a workspace may change every time a key is pressed, you can work with the model of the solution in isolation.</span></span>

<span data-ttu-id="3ceba-118">ソリューションはプロジェクトとドキュメントの不変モデルです。</span><span class="sxs-lookup"><span data-stu-id="3ceba-118">A solution is an immutable model of the projects and documents.</span></span> <span data-ttu-id="3ceba-119">つまり、モデルはロックしたり複製したりしなくても共有することができます。</span><span class="sxs-lookup"><span data-stu-id="3ceba-119">This means that the model can be shared without locking or duplication.</span></span> <span data-ttu-id="3ceba-120"><xref:Microsoft.CodeAnalysis.Workspace.CurrentSolution?displayProperty=nameWithType> プロパティからソリューション インスタンスを取得した後、そのインスタンスが変わることはありません。</span><span class="sxs-lookup"><span data-stu-id="3ceba-120">After you obtain a solution instance from the <xref:Microsoft.CodeAnalysis.Workspace.CurrentSolution?displayProperty=nameWithType> property, that instance will never change.</span></span> <span data-ttu-id="3ceba-121">ただし、構文ツリーやコンパイルの場合と同じように、既存のソリューションと特定の変更に基づいて新しいインスタンスを構築することで、ソリューションを変更できます。</span><span class="sxs-lookup"><span data-stu-id="3ceba-121">However, like with syntax trees and compilations, you can modify solutions by constructing new instances based on existing solutions and specific changes.</span></span> <span data-ttu-id="3ceba-122">ワークスペースで変更を反映するには、変更されたソリューションをワークスペースに明示的に適用し直す必要があります。</span><span class="sxs-lookup"><span data-stu-id="3ceba-122">To get the workspace to reflect your changes, you must explicitly apply the changed solution back to the workspace.</span></span>

<span data-ttu-id="3ceba-123">プロジェクトは、不変ソリューション モデル全体の一部です。</span><span class="sxs-lookup"><span data-stu-id="3ceba-123">A project is a part of the overall immutable solution model.</span></span> <span data-ttu-id="3ceba-124">ソース コード ドキュメント、解析とコンパイル オプション、アセンブリとプロジェクト間の両方の参照をすべて表します。</span><span class="sxs-lookup"><span data-stu-id="3ceba-124">It represents all the source code documents, parse and compilation options, and both assembly and project-to-project references.</span></span> <span data-ttu-id="3ceba-125">プロジェクトから対応するコンパイルにアクセスできます。プロジェクトの依存関係を判別したり、ソース ファイルを解析する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="3ceba-125">From a project, you can access the corresponding compilation without needing to determine project dependencies or parse any source files.</span></span>

<span data-ttu-id="3ceba-126">ドキュメントも不変ソリューション モデル全体の一部です。</span><span class="sxs-lookup"><span data-stu-id="3ceba-126">A document is also a part of the overall immutable solution model.</span></span> <span data-ttu-id="3ceba-127">ドキュメントは単一のソース ファイルを表すものであり、そこからファイルのテキスト、構文ツリー、セマンティック モデルにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="3ceba-127">A document represents a single source file from which you can access the text of the file, the syntax tree, and the semantic model.</span></span>

<span data-ttu-id="3ceba-128">次の図は、ワークスペースとホスト環境やツールとの関係、および編集がどのように行われるかを示しています。</span><span class="sxs-lookup"><span data-stu-id="3ceba-128">The following diagram is a representation of how the Workspace relates to the host environment, tools, and how edits are made.</span></span>

![プロジェクトとソース ファイルを含む、ワークスペースのさまざまな要素間の関係](media/work-with-workspace/workspace-obj-relations.png)

## <a name="summary"></a><span data-ttu-id="3ceba-130">まとめ</span><span class="sxs-lookup"><span data-stu-id="3ceba-130">Summary</span></span>

<span data-ttu-id="3ceba-131">Roslyn では一連のコンパイラ API とワークスペース API が公開されます。これらの API は、ソース コードに関する豊富な情報を提供し、C# および Visual Basic 言語を完全に再現します。</span><span class="sxs-lookup"><span data-stu-id="3ceba-131">Roslyn exposes a set of compiler APIs and Workspaces APIs that provides rich information about your source code and that has full fidelity with the C# and Visual Basic languages.</span></span>  <span data-ttu-id="3ceba-132">.NET Compiler Platform SDK は、コードにフォーカスされたツールとアプリケーションの作成における参入障壁を劇的に低くします。</span><span class="sxs-lookup"><span data-stu-id="3ceba-132">The .NET Compiler Platform SDK dramatically lowers the barrier to entry for creating code-focused tools and applications.</span></span> <span data-ttu-id="3ceba-133">これにより、メタプログラミング、コードの生成と変換、C# と Visual Basic 言語の対話型の使用、ドメイン固有の言語での C# と Visual Basic の埋め込みなどの領域で、多くのイノベーションの機会が生み出されます。</span><span class="sxs-lookup"><span data-stu-id="3ceba-133">It creates many opportunities for innovation in areas such as meta-programming, code generation and transformation, interactive use of the C# and Visual Basic languages, and embedding of C# and Visual Basic in domain-specific languages.</span></span>  
