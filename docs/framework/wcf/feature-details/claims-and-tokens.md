---
description: 詳細については、「クレームとトークン」を参照してください。
title: クレームとトークン
ms.date: 03/30/2017
helpviewer_keywords:
- claims [WCF], and tokens
ms.assetid: eff167f3-33f8-483d-a950-aa3e9f97a189
ms.openlocfilehash: d7d05fb63886ca7562ce478bcbcea73c3cbafcb8
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/06/2021
ms.locfileid: "99734959"
---
# <a name="claims-and-tokens"></a><span data-ttu-id="3dfc4-103">クレームとトークン</span><span class="sxs-lookup"><span data-stu-id="3dfc4-103">Claims and Tokens</span></span>

<span data-ttu-id="3dfc4-104">このトピックでは、Windows Communication Foundation (WCF) によってサポートされる既定のトークンから作成されるさまざまな種類の要求について説明します。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-104">This topic describes the various claim types that Windows Communication Foundation (WCF) creates from the default tokens that it supports.</span></span>

<span data-ttu-id="3dfc4-105">クライアント資格情報のクレームは、<xref:System.IdentityModel.Claims.ClaimSet> クラスと <xref:System.IdentityModel.Claims.Claim> クラスを使用して確認できます。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-105">You can examine the claims of a client credential by using the <xref:System.IdentityModel.Claims.ClaimSet> and <xref:System.IdentityModel.Claims.Claim> classes.</span></span> <span data-ttu-id="3dfc4-106">`ClaimSet` には、`Claim` オブジェクトのコレクションが含まれます。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-106">The `ClaimSet` contains a collection of `Claim` objects.</span></span> <span data-ttu-id="3dfc4-107">各 `Claim` には、次の重要なメンバーがあります。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-107">Each `Claim` has the following important members:</span></span>

- <span data-ttu-id="3dfc4-108"><xref:System.IdentityModel.Claims.Claim.ClaimType%2A> プロパティは、作成されるクレームの種類を指定する URI (Uniform Resource Identifier) を返します。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-108">The <xref:System.IdentityModel.Claims.Claim.ClaimType%2A> property returns a Uniform Resource Identifier (URI) that specifies the type of claim being made.</span></span> <span data-ttu-id="3dfc4-109">たとえば、クレームの種類として証明書の拇印を指定できます。この場合、URI は `http://schemas.microsoft.com/ws/20005/05/identity/claims/thumprint` です。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-109">For example, a claim type may be a thumbprint of a certificate, in which case the URI is `http://schemas.microsoft.com/ws/20005/05/identity/claims/thumprint`.</span></span>

- <span data-ttu-id="3dfc4-110"><xref:System.IdentityModel.Claims.Claim.Right%2A> プロパティは、クレームの権限を指定する URI を返します。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-110">The <xref:System.IdentityModel.Claims.Claim.Right%2A> property returns a URI that specifies the right of the claim.</span></span> <span data-ttu-id="3dfc4-111">定義済みの権限は、<xref:System.IdentityModel.Claims.Rights> クラスにあります (<xref:System.IdentityModel.Claims.Rights.Identity%2A>、<xref:System.IdentityModel.Claims.Rights.PossessProperty%2A>)。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-111">Predefined rights are found in the <xref:System.IdentityModel.Claims.Rights> class (<xref:System.IdentityModel.Claims.Rights.Identity%2A>,  <xref:System.IdentityModel.Claims.Rights.PossessProperty%2A>).</span></span>

- <span data-ttu-id="3dfc4-112"><xref:System.IdentityModel.Claims.Claim.Resource%2A> プロパティは、クレームに関連付けられているリソースを返します。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-112">The <xref:System.IdentityModel.Claims.Claim.Resource%2A> property returns the resource associated with the claim.</span></span>

<span data-ttu-id="3dfc4-113">各 <xref:System.IdentityModel.Claims.ClaimSet> には、<xref:System.IdentityModel.Claims.ClaimSet.Issuer%2A> プロパティがあり、それぞれ <xref:System.IdentityModel.Claims.ClaimSet> の `Issuer` を表します。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-113">Each <xref:System.IdentityModel.Claims.ClaimSet> also has an <xref:System.IdentityModel.Claims.ClaimSet.Issuer%2A> property, which represents the <xref:System.IdentityModel.Claims.ClaimSet> of the `Issuer`.</span></span>

## <a name="windows-accounts"></a><span data-ttu-id="3dfc4-114">Windows アカウント</span><span class="sxs-lookup"><span data-stu-id="3dfc4-114">Windows Accounts</span></span>

<span data-ttu-id="3dfc4-115">クライアント資格情報が Windows ユーザー アカウントにマップされる場合、<xref:System.IdentityModel.Claims.ClaimSet> は次の値を格納します。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-115">Where a client credential maps to a Windows user account, the resulting <xref:System.IdentityModel.Claims.ClaimSet> has the following values:</span></span>

- <span data-ttu-id="3dfc4-116">`Issuer` は、<xref:System.IdentityModel.Claims.ClaimSet> クラスの静的 Windows プロパティによって返される値です。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-116">The `Issuer` is the value returned by the static Windows property of the <xref:System.IdentityModel.Claims.ClaimSet> class.</span></span>

- <span data-ttu-id="3dfc4-117">コレクションには次のクレームがあります。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-117">The claims in the collection are:</span></span>

  - <span data-ttu-id="3dfc4-118"><xref:System.IdentityModel.Claims.Claim> 値がセキュリティ識別子 (SID)、<xref:System.IdentityModel.Claims.Claim.ClaimType%2A> プロパティ値が <xref:System.IdentityModel.Claims.Claim.Right%2A> で、`Identity` が実際の SID 値を返す <xref:System.IdentityModel.Claims.Claim.Resource%2A>。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-118">A <xref:System.IdentityModel.Claims.Claim> with a <xref:System.IdentityModel.Claims.Claim.ClaimType%2A> value of security identifier (SID), a <xref:System.IdentityModel.Claims.Claim.Right%2A> property value of `Identity`, and a <xref:System.IdentityModel.Claims.Claim.Resource%2A> that returns the actual SID value.</span></span> <span data-ttu-id="3dfc4-119">SID は、ドメイン コントローラーによって各ユーザーに発行される一意の値です。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-119">A SID is a unique value the domain controller issues to every user.</span></span> <span data-ttu-id="3dfc4-120">SID は、Windows セキュリティとの対話でユーザーを識別するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-120">The SID is used to identify the user in interactions with Windows security.</span></span>

  - <span data-ttu-id="3dfc4-121"><xref:System.IdentityModel.Claims.Claim> 値 が SID、<xref:System.IdentityModel.Claims.Claim.ClaimType%2A> が <xref:System.IdentityModel.Claims.Claim.Right%2A> で、`PossessProperty` が SID 値の <xref:System.IdentityModel.Claims.Claim.Resource%2A>。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-121">A <xref:System.IdentityModel.Claims.Claim> with a <xref:System.IdentityModel.Claims.Claim.ClaimType%2A> value of SID, a <xref:System.IdentityModel.Claims.Claim.Right%2A> of `PossessProperty`, and a <xref:System.IdentityModel.Claims.Claim.Resource%2A> of the SID value.</span></span>

  - <span data-ttu-id="3dfc4-122"><xref:System.IdentityModel.Claims.Claim> が <xref:System.IdentityModel.Claims.Claim.ClaimType%2A>、<xref:System.IdentityModel.Claims.ClaimTypes.Name%2A> が <xref:System.IdentityModel.Claims.Claim.Right%2A> で、`PossessProperty` がユーザー名 (たとえば、"MYMACHINE\Bob") を含んだ文字列である <xref:System.IdentityModel.Claims.Claim.Resource%2A>。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-122">A <xref:System.IdentityModel.Claims.Claim> with a <xref:System.IdentityModel.Claims.Claim.ClaimType%2A> of <xref:System.IdentityModel.Claims.ClaimTypes.Name%2A>, a <xref:System.IdentityModel.Claims.Claim.Right%2A> of `PossessProperty` and a <xref:System.IdentityModel.Claims.Claim.Resource%2A> of string containing the user name (for example, "MYMACHINE\Bob").</span></span>

  - <span data-ttu-id="3dfc4-123">ユーザーが属するさまざまなグループの <xref:System.IdentityModel.Claims.Rights.PossessProperty%2A> が指定された追加の SID クレーム。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-123">Additional SID claims with <xref:System.IdentityModel.Claims.Rights.PossessProperty%2A> for the various groups the user belongs to.</span></span>

## <a name="certificates"></a><span data-ttu-id="3dfc4-124">証明書</span><span class="sxs-lookup"><span data-stu-id="3dfc4-124">Certificates</span></span>

<span data-ttu-id="3dfc4-125">クライアント資格情報が証明書の場合、<xref:System.IdentityModel.Claims.ClaimSet> は次の値を格納します。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-125">Where the client credential is a certificate, the resulting <xref:System.IdentityModel.Claims.ClaimSet> has the following values:</span></span>

- <span data-ttu-id="3dfc4-126">自己発行証明書の場合、`Issuer` は <xref:System.IdentityModel.Claims.ClaimSet> です。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-126">For self-issued certificates, the `Issuer` is the <xref:System.IdentityModel.Claims.ClaimSet> itself.</span></span> <span data-ttu-id="3dfc4-127"><xref:System.IdentityModel.Claims.ClaimSet> は、<xref:System.IdentityModel.Claims.Claim.ClaimType%2A> に設定された <xref:System.IdentityModel.Claims.ClaimTypes.Thumbprint%2A>、<xref:System.IdentityModel.Claims.Claim.Right%2A> に設定された `Identity`、および証明書の拇印を含んだ <xref:System.IdentityModel.Claims.Claim.Resource%2A> 配列である <xref:System.Byte> 値を返します。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-127">The <xref:System.IdentityModel.Claims.ClaimSet> returns a <xref:System.IdentityModel.Claims.Claim.ClaimType%2A> of <xref:System.IdentityModel.Claims.ClaimTypes.Thumbprint%2A>, a <xref:System.IdentityModel.Claims.Claim.Right%2A> of `Identity`, and a <xref:System.IdentityModel.Claims.Claim.Resource%2A> value that is a <xref:System.Byte> array containing the thumbprint of the certificate.</span></span>

- <span data-ttu-id="3dfc4-128">証明機関によって発行された証明書の場合、発行者は、証明機関の証明書を表す `ClaimSet` です。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-128">For a certificate issued by a certification authority, the issuer is the `ClaimSet` representing the certification authority’s certificate.</span></span>

- <span data-ttu-id="3dfc4-129">コレクションの `Claims` には次のものが含まれます。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-129">The `Claims` in the collection include:</span></span>

  - <span data-ttu-id="3dfc4-130">`Claim` が Thumbprint、`ClaimType` が PossessProperty で、`Right` が証明書の拇印を含んだバイト配列である `Resource`。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-130">A `Claim` with a `ClaimType` of Thumbprint, a `Right` of PossessProperty, and a `Resource` that is a byte array containing the thumbprint of the certificate</span></span>

  - <span data-ttu-id="3dfc4-131">証明書のさまざまなプロパティを表す X500DistinguishedName、Dns、Name、Upn、Rsa などの複数の種類の追加の PossessProperty クレーム。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-131">Additional PossessProperty claims of various types, including X500DistinguishedName, Dns, Name, Upn, and Rsa, represent various properties of the certificate.</span></span> <span data-ttu-id="3dfc4-132">Rsa 要求のリソースは、証明書に関連付けられている公開キーです。**メモ** クライアント資格情報の種類が、サービスが Windows アカウントにマップする証明書である場合、2つの `ClaimSet` オブジェクトが生成されます。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-132">The resource for the Rsa claim is the public key associated with the certificate.**Note** Where the client credential type is a certificate that the service maps to a Windows account, two `ClaimSet` objects are generated.</span></span> <span data-ttu-id="3dfc4-133">最初のオブジェクトには、Windows アカウントに関するすべてのクレームが入り、2 番目のオブジェクトには、証明書に関するすべてのクレームが入ります。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-133">The first contains all the claims related to the Windows account and the second contains all the claims related to the certificate.</span></span>

## <a name="user-namepassword"></a><span data-ttu-id="3dfc4-134">ユーザー名/パスワード</span><span class="sxs-lookup"><span data-stu-id="3dfc4-134">User Name/Password</span></span>

<span data-ttu-id="3dfc4-135">クライアント資格情報が、Windows アカウントにマップされないユーザー名とパスワード (または同等のもの) の場合、`ClaimSet` は、<xref:System.IdentityModel.Claims.ClaimSet.System%2A> クラスの静的 `ClaimSet` プロパティによって発行されます。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-135">Where the client credential is a user name/password (or equivalent) that does not map to a Windows account, the resulting `ClaimSet` is issued by the static <xref:System.IdentityModel.Claims.ClaimSet.System%2A> property of the `ClaimSet` class.</span></span> <span data-ttu-id="3dfc4-136">には、 `ClaimSet` `Identity` <xref:System.IdentityModel.Claims.ClaimTypes.Name%2A> クライアントが提供するユーザー名であるリソースを持つ型のクレームが含まれています。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-136">The `ClaimSet` contains an `Identity` claim of type <xref:System.IdentityModel.Claims.ClaimTypes.Name%2A> whose resource is the user name the client provides.</span></span> <span data-ttu-id="3dfc4-137">対応するクレームには、`Right` の`PossessProperty` があります。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-137">A corresponding claim has a `Right` of `PossessProperty`.</span></span>

## <a name="rsa-keys"></a><span data-ttu-id="3dfc4-138">RSA キー</span><span class="sxs-lookup"><span data-stu-id="3dfc4-138">RSA Keys</span></span>

<span data-ttu-id="3dfc4-139">証明書に関連付けられていない RSA キーが使用される場合、その結果 `ClaimSet` は自己発行され、 `Identity` <xref:System.IdentityModel.Claims.ClaimTypes.Rsa%2A> リソースが RSA キーである型のクレームが含まれます。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-139">Where an RSA key not associated with a certificate is used, the resulting `ClaimSet` is self-issued and contains an `Identity` claim of type <xref:System.IdentityModel.Claims.ClaimTypes.Rsa%2A> whose resource is the RSA key.</span></span> <span data-ttu-id="3dfc4-140">対応するクレームには、`Right` の`PossessProperty` があります。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-140">A corresponding claim has a `Right` of `PossessProperty`.</span></span>

## <a name="saml"></a><span data-ttu-id="3dfc4-141">SAML</span><span class="sxs-lookup"><span data-stu-id="3dfc4-141">SAML</span></span>

<span data-ttu-id="3dfc4-142">クライアントが SAML (Security Assertions Markup Language) トークンを使用して認証する場合、`ClaimSet` は、SAML トークンを署名したエンティティ (通常は、SAML トークンを発行したセキュリティ トークン サービス (STS) の証明書) によって発行されます。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-142">Where the client authenticates with a Security Assertions Markup Language (SAML) token, the resulting `ClaimSet` is issued by the entity that signed the SAML token, often the certificate of the security token service (STS) that issued the SAML token.</span></span> <span data-ttu-id="3dfc4-143">`ClaimSet` は、SAML トークンに含まれているとおりのさまざまなクレームを格納します。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-143">The `ClaimSet` contains various claims as found in the SAML token.</span></span> <span data-ttu-id="3dfc4-144">SAML トークンが、名前が `SamlSubject` 以外の `null` を含んでいる場合、型が `Identity` で、リソース型が <xref:System.IdentityModel.Claims.ClaimTypes.NameIdentifier%2A> の <xref:System.IdentityModel.Tokens.SamlNameIdentifierClaimResource> クレームが作成されます。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-144">If the SAML token contains a `SamlSubject` with a non-`null` name, then an `Identity` claim with a type of <xref:System.IdentityModel.Claims.ClaimTypes.NameIdentifier%2A> and a resource type of <xref:System.IdentityModel.Tokens.SamlNameIdentifierClaimResource> are created.</span></span>

## <a name="identity-claims-and-servicesecuritycontextisanonymous"></a><span data-ttu-id="3dfc4-145">Identity クレームと ServiceSecurityContext.IsAnonymous</span><span class="sxs-lookup"><span data-stu-id="3dfc4-145">Identity Claims and ServiceSecurityContext.IsAnonymous</span></span>

<span data-ttu-id="3dfc4-146">クライアント資格情報の結果として生成されたオブジェクトにが `ClaimSet` の要求が含まれていない場合 `Right` `Identity,` 、 <xref:System.ServiceModel.ServiceSecurityContext.IsAnonymous%2A> プロパティはを返し `true` ます。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-146">If none of the `ClaimSet` objects resulting from the client credentials contain a claim with a `Right` of `Identity,` then the <xref:System.ServiceModel.ServiceSecurityContext.IsAnonymous%2A> property returns `true`.</span></span> <span data-ttu-id="3dfc4-147">このようなクレームが 1 つ以上ある場合、`IsAnonymous` プロパティは `false` を返します。</span><span class="sxs-lookup"><span data-stu-id="3dfc4-147">If one or more such claims are present, the `IsAnonymous` property returns `false`.</span></span>

## <a name="see-also"></a><span data-ttu-id="3dfc4-148">関連項目</span><span class="sxs-lookup"><span data-stu-id="3dfc4-148">See also</span></span>

- <xref:System.IdentityModel.Claims.ClaimSet>
- <xref:System.IdentityModel.Claims.Claim>
- <xref:System.IdentityModel.Claims.Rights>
- <xref:System.IdentityModel.Claims.ClaimTypes>
- [<span data-ttu-id="3dfc4-149">ID モデルを使用したクレームと承認の管理</span><span class="sxs-lookup"><span data-stu-id="3dfc4-149">Managing Claims and Authorization with the Identity Model</span></span>](managing-claims-and-authorization-with-the-identity-model.md)
