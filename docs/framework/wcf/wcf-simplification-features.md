---
description: 詳細については、「WCF の簡略化機能」を参照してください。
title: WCF の単純化機能
ms.date: 03/30/2017
ms.assetid: 4535a511-6064-4da0-b361-80262a891663
ms.openlocfilehash: cf89ff7775e2a162760c3c6c598a045ddccdf8d8
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/06/2021
ms.locfileid: "99703380"
---
# <a name="wcf-simplification-features"></a><span data-ttu-id="882ef-103">WCF の単純化機能</span><span class="sxs-lookup"><span data-stu-id="882ef-103">WCF Simplification Features</span></span>

<span data-ttu-id="882ef-104">ここでは、WCF アプリケーションの作成を容易にする新機能について説明します。</span><span class="sxs-lookup"><span data-stu-id="882ef-104">This topic discusses new features that make writing WCF applications simpler.</span></span>

## <a name="simplified-generated-configuration-files"></a><span data-ttu-id="882ef-105">生成された構成ファイルの簡略化</span><span class="sxs-lookup"><span data-stu-id="882ef-105">Simplified Generated Configuration Files</span></span>

<span data-ttu-id="882ef-106">Visual Studio でサービス参照を追加したり、SvcUtil.exe ツールを使用したりすると、クライアント構成ファイルが生成されます。</span><span class="sxs-lookup"><span data-stu-id="882ef-106">When you add a service reference in Visual Studio or use the SvcUtil.exe tool a client configuration file is generated.</span></span> <span data-ttu-id="882ef-107">以前のバージョンの WCF では、このような構成ファイルには、各バインド プロパティの値が既定値であっても、その値が含まれていました。</span><span class="sxs-lookup"><span data-stu-id="882ef-107">In previous versions of WCF these configuration files contained the value of every binding property even if its value is the default value.</span></span> <span data-ttu-id="882ef-108">WCF 4.5 では、生成された構成ファイルには、既定値以外の値に設定されているバインド プロパティのみが含まれます。</span><span class="sxs-lookup"><span data-stu-id="882ef-108">In WCF 4.5 the generated configuration files contain only those binding properties that are set to a non-default value.</span></span>

<span data-ttu-id="882ef-109">WCF 3.0 で生成された構成ファイルの例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="882ef-109">The following is an example of a configuration file generated by WCF 3.0.</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
    <system.serviceModel>
        <bindings>
            <basicHttpBinding>
                <binding name="BasicHttpBinding_IService1" closeTimeout="00:01:00"
                    openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
                    allowCookies="false" bypassProxyOnLocal="false"
                    hostNameComparisonMode="StrongWildcard" maxBufferSize="65536"
                    maxBufferPoolSize="524288" maxReceivedMessageSize="65536"
                    messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
                    useDefaultWebProxy="true">
                    <readerQuotas maxDepth="32" maxStringContentLength="8192"
                        maxArrayLength="16384" maxBytesPerRead="4096"
                        maxNameTableCharCount="16384" />
                    <security mode="None">
                        <transport clientCredentialType="None" proxyCredentialType="None"
                            realm="" />
                        <message clientCredentialType="UserName" algorithmSuite="Default" />
                    </security>
                </binding>
            </basicHttpBinding>
        </bindings>
        <client>
            <endpoint address="http://localhost:36906/Service1.svc" binding="basicHttpBinding"
                bindingConfiguration="BasicHttpBinding_IService1" contract="IService1"
                name="BasicHttpBinding_IService1" />
        </client>
    </system.serviceModel>
</configuration>
```

<span data-ttu-id="882ef-110">WCF 4.5 で生成された同じ構成ファイルの例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="882ef-110">The following is an example of the same configuration file generated by WCF 4.5.</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
    <system.serviceModel>
        <bindings>
            <basicHttpBinding>
                <binding name="BasicHttpBinding_IService1" />
            </basicHttpBinding>
        </bindings>
        <client>
            <endpoint address="http://localhost:36906/Service1.svc" binding="basicHttpBinding"
                bindingConfiguration="BasicHttpBinding_IService1" contract="IService1"
                name="BasicHttpBinding_IService1" />
        </client>
    </system.serviceModel>
</configuration>
```

## <a name="contract-first-development"></a><span data-ttu-id="882ef-111">コントラクト優先の開発</span><span class="sxs-lookup"><span data-stu-id="882ef-111">Contract-First Development</span></span>

<span data-ttu-id="882ef-112">WCF では、コントラクト優先の開発がサポートされるようになりました。</span><span class="sxs-lookup"><span data-stu-id="882ef-112">WCF now has support for contract-first development.</span></span> <span data-ttu-id="882ef-113">svcutil.exe ツールには、WSDL ドキュメントからサービスコントラクトとデータコントラクトを生成するための/serviceContract スイッチがあります。</span><span class="sxs-lookup"><span data-stu-id="882ef-113">The svcutil.exe tool has a /serviceContract switch which allows you to generate service and data contracts from a WSDL document.</span></span>

## <a name="add-service-reference-from-a-portable-subset-project"></a><span data-ttu-id="882ef-114">ポータブル サブセット プロジェクトからのサービス参照の追加</span><span class="sxs-lookup"><span data-stu-id="882ef-114">Add Service Reference From a Portable Subset Project</span></span>

<span data-ttu-id="882ef-115">ポータブルサブセットプロジェクトを使用すると、.NET アセンブリプログラマは、1つのソースツリーとビルドシステムを維持しながら、複数の .NET 実装 (デスクトップ、Silverlight、Windows Phone、Xbox) を引き続きサポートできます。</span><span class="sxs-lookup"><span data-stu-id="882ef-115">Portable subset projects enable .NET assembly programmers to maintain a single source tree and build system while still supporting multiple .NET implementations (desktop, Silverlight, Windows Phone, and Xbox).</span></span> <span data-ttu-id="882ef-116">ポータブルサブセットプロジェクトは、任意の .NET 実装で使用できるアセンブリである .NET ポータブルライブラリのみを参照します。</span><span class="sxs-lookup"><span data-stu-id="882ef-116">Portable subset projects only reference .NET portable libraries that are assemblies that can be used on any .NET implementation.</span></span> <span data-ttu-id="882ef-117">開発者から見れば、他の WCF クライアント アプリケーション内でサービス参照を追加するのと同じです。</span><span class="sxs-lookup"><span data-stu-id="882ef-117">The developer experience is the same as adding a service reference within any other WCF client application.</span></span> <span data-ttu-id="882ef-118">詳細については、「 [ポータブルサブセットプロジェクトでのサービス参照の追加](add-service-reference-in-a-portable-subset-project.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="882ef-118">For more information, see [Add Service Reference in a Portable Subset Project](add-service-reference-in-a-portable-subset-project.md).</span></span>

## <a name="aspnet-compatibility-mode-default-changed"></a><span data-ttu-id="882ef-119">ASP.NET 互換性モードの既定値の変更</span><span class="sxs-lookup"><span data-stu-id="882ef-119">ASP.NET Compatibility Mode Default Changed</span></span>

<span data-ttu-id="882ef-120">WCF には ASP.NET 互換性モードが用意されています。これにより、開発者は WCF サービスを作成する際に ASP.NET HTTP パイプラインの機能へのフル アクセスが付与されます。</span><span class="sxs-lookup"><span data-stu-id="882ef-120">WCF provides ASP.NET compatibility mode to grant developers full access to the features in the ASP.NET HTTP pipeline when writing WCF services.</span></span> <span data-ttu-id="882ef-121">このモードを使用するには、 `aspNetCompatibilityEnabled` web.config のセクションで属性を true に設定する必要があり [\<serviceHostingEnvironment>](../configure-apps/file-schema/wcf/servicehostingenvironment.md) ます。また、この appDomain のすべてのサービス `RequirementsMode` <xref:System.ServiceModel.Activation.AspNetCompatibilityRequirementsAttribute> は、をまたはに設定して、プロパティを持つ必要があり <xref:System.ServiceModel.Activation.AspNetCompatibilityRequirementsMode.Allowed> <xref:System.ServiceModel.Activation.AspNetCompatibilityRequirementsMode.Required> ます。</span><span class="sxs-lookup"><span data-stu-id="882ef-121">To use this mode, you must set the `aspNetCompatibilityEnabled` attribute to true in the [\<serviceHostingEnvironment>](../configure-apps/file-schema/wcf/servicehostingenvironment.md) section of web.config. Additionally, any service in this appDomain needs to have the `RequirementsMode` property on its <xref:System.ServiceModel.Activation.AspNetCompatibilityRequirementsAttribute> set to <xref:System.ServiceModel.Activation.AspNetCompatibilityRequirementsMode.Allowed> or <xref:System.ServiceModel.Activation.AspNetCompatibilityRequirementsMode.Required>.</span></span> <span data-ttu-id="882ef-122">既定で <xref:System.ServiceModel.Activation.AspNetCompatibilityRequirementsAttribute> は、はに設定され、 <xref:System.ServiceModel.Activation.AspNetCompatibilityRequirementsMode.Allowed> 既定の WCF サービスアプリケーションテンプレートは属性をに設定し `aspNetCompatibilityEnabled` `true` ます。</span><span class="sxs-lookup"><span data-stu-id="882ef-122">By default <xref:System.ServiceModel.Activation.AspNetCompatibilityRequirementsAttribute> is now set to <xref:System.ServiceModel.Activation.AspNetCompatibilityRequirementsMode.Allowed> and the default WCF service application template sets the `aspNetCompatibilityEnabled` attribute to `true`.</span></span> <span data-ttu-id="882ef-123">詳細については、「Windows Communication Foundation 4.5 および[WCF サービスと ASP.NET](./feature-details/wcf-services-and-aspnet.md)[の新機能](whats-new.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="882ef-123">For more information, see [What's New in Windows Communication Foundation 4.5](whats-new.md) and [WCF Services and ASP.NET](./feature-details/wcf-services-and-aspnet.md).</span></span>

## <a name="streaming-improvements"></a><span data-ttu-id="882ef-124">ストリーミングの強化</span><span class="sxs-lookup"><span data-stu-id="882ef-124">Streaming Improvements</span></span>

- <span data-ttu-id="882ef-125">非同期ストリーミングに対する新しいサポートが WCF に追加されました。</span><span class="sxs-lookup"><span data-stu-id="882ef-125">New support for asynchronous streaming has been added to WCF.</span></span> <span data-ttu-id="882ef-126">非同期ストリーミングを有効にするには、エンドポイントの <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior> 動作をサービス ホストに追加し、その <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior.AsynchronousSendEnabled%2A> プロパティを `true` に設定します。</span><span class="sxs-lookup"><span data-stu-id="882ef-126">To enable asynchronous streaming, add the  <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior> endpoint behavior to the service host and set its <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior.AsynchronousSendEnabled%2A> property to `true`.</span></span> <span data-ttu-id="882ef-127">これにより、読み取りに時間のかかる複数のクライアントに対してサービスがストリーム メッセージを送信するときにスケーラビリティが得られます。</span><span class="sxs-lookup"><span data-stu-id="882ef-127">This can benefit scalability when a service is sending streamed messages to multiple clients which are reading slowly.</span></span> <span data-ttu-id="882ef-128">WCF では、クライアントごとに 1 つのスレッドがブロックされなくなり、別のクライアントにサービスを提供するためにスレッドを解放します。</span><span class="sxs-lookup"><span data-stu-id="882ef-128">WCF does not block one thread per client anymore and will free up the thread to service another client.</span></span>

- <span data-ttu-id="882ef-129">サービスが IIS でホストされるときのメッセージのバッファー処理に関する制限がなくなりました。</span><span class="sxs-lookup"><span data-stu-id="882ef-129">Removed limitations around buffering of messages when a service is IIS hosted.</span></span> <span data-ttu-id="882ef-130">以前のバージョンの WCF では、ストリーム メッセージ転送を使用する IIS でホストされるサービスに対するメッセージを受信すると、ASP.NET はメッセージ全体を WCF に送信する前にバッファー処理しました。</span><span class="sxs-lookup"><span data-stu-id="882ef-130">In previous versions of WCF when receiving a message for an IIS-hosted service that used streaming message transfer, ASP.NET would buffer the entire message before sending it to WCF.</span></span> <span data-ttu-id="882ef-131">これにより、メモリの大量消費が発生しました。</span><span class="sxs-lookup"><span data-stu-id="882ef-131">This would cause large memory consumption.</span></span> <span data-ttu-id="882ef-132">このバッファリングは .NET Framework 4.5 では削除されており、IIS でホストされる WCF サービスはメッセージ全体を受信する前に受信ストリームの処理を開始できるようになりました。これにより、真のストリーミングが有効になります。</span><span class="sxs-lookup"><span data-stu-id="882ef-132">This buffering has been removed in .NET Framework 4.5 and now IIS-hosted WCF services can start processing the incoming stream before the entire message has been received, thereby enabling true streaming.</span></span> <span data-ttu-id="882ef-133">これにより、WCF は、メッセージにすぐに応答できるようになり、パフォーマンスは向上します。</span><span class="sxs-lookup"><span data-stu-id="882ef-133">This allows WCF to respond immediately to messages and allows improved performance.</span></span> <span data-ttu-id="882ef-134">さらに、着信要求に対する ASP.NET のサイズ制限である `maxRequestLength` の値を指定する必要がなくなりました。</span><span class="sxs-lookup"><span data-stu-id="882ef-134">In addition, you no longer have to specify a value for `maxRequestLength`, the ASP.NET size limit on incoming requests.</span></span> <span data-ttu-id="882ef-135">このプロパティを設定した場合、このプロパティは無視されます。</span><span class="sxs-lookup"><span data-stu-id="882ef-135">If this property is set, it is ignored.</span></span> <span data-ttu-id="882ef-136">の詳細については、 `maxRequestLength` 「 [ \<httpRuntime> configuration 要素](/previous-versions/dotnet/netframework-1.1/e1f13641(v=vs.71))」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="882ef-136">For more information about `maxRequestLength` see [\<httpRuntime> configuration element](/previous-versions/dotnet/netframework-1.1/e1f13641(v=vs.71)).</span></span> <span data-ttu-id="882ef-137">MaxAllowedContentLength を構成する必要があります。詳細については、「 [IIS 要求の制限](/previous-versions/iis/settings-schema/ms689462(v=vs.90))」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="882ef-137">You will still need to configure the maxAllowedContentLength, For more information, see [IIS Request Limits](/previous-versions/iis/settings-schema/ms689462(v=vs.90)).</span></span>

## <a name="new-transport-default-values"></a><span data-ttu-id="882ef-138">トランスポートの新しい既定値</span><span class="sxs-lookup"><span data-stu-id="882ef-138">New Transport Default Values</span></span>

<span data-ttu-id="882ef-139">次の表は、変更された設定と追加情報の場所を示しています。</span><span class="sxs-lookup"><span data-stu-id="882ef-139">The following table describes the settings that have changed and where to find additional information.</span></span>

|<span data-ttu-id="882ef-140">プロパティ</span><span class="sxs-lookup"><span data-stu-id="882ef-140">Property</span></span>|<span data-ttu-id="882ef-141">オン</span><span class="sxs-lookup"><span data-stu-id="882ef-141">On</span></span>|<span data-ttu-id="882ef-142">新しい既定値</span><span class="sxs-lookup"><span data-stu-id="882ef-142">New Default</span></span>|<span data-ttu-id="882ef-143">詳細情報</span><span class="sxs-lookup"><span data-stu-id="882ef-143">More Information</span></span>|
|--------------|--------|-----------------|----------------------|
|<span data-ttu-id="882ef-144">channelInitializationTimeout</span><span class="sxs-lookup"><span data-stu-id="882ef-144">channelInitializationTimeout</span></span>|<xref:System.ServiceModel.NetTcpBinding>|<span data-ttu-id="882ef-145">30 秒</span><span class="sxs-lookup"><span data-stu-id="882ef-145">30 seconds</span></span>|<span data-ttu-id="882ef-146">このプロパティは、TCP 接続が .NET フレーミングプロトコルを使用して自身を認証するために実行できる時間を決定します。</span><span class="sxs-lookup"><span data-stu-id="882ef-146">This property determines how long a TCP connection can take to authenticate itself using the .NET Framing protocol.</span></span> <span data-ttu-id="882ef-147">クライアントは、サーバーが認証を実行するための十分な情報を得る前に初期データを送信する必要があります。</span><span class="sxs-lookup"><span data-stu-id="882ef-147">A client needs to send some initial data before the server has enough information to perform authentication.</span></span> <span data-ttu-id="882ef-148">このタイムアウトは意図的に ReceiveTimeout (10 分) よりも小さい値に設定されます。これにより、悪意のある認証されていないクライアントは、長時間にわたってサーバーへの接続を保持できません。</span><span class="sxs-lookup"><span data-stu-id="882ef-148">This timeout is intentionally made smaller than the ReceiveTimeout (10 min) so that malicious unauthenticated clients do not keep the connections tied up to the server for long.</span></span> <span data-ttu-id="882ef-149">既定値は 30 秒です。</span><span class="sxs-lookup"><span data-stu-id="882ef-149">The default value is 30 seconds.</span></span> <span data-ttu-id="882ef-150">の詳細については、 <xref:System.ServiceModel.Channels.ConnectionOrientedTransportBindingElement.ChannelInitializationTimeout%2A></span><span class="sxs-lookup"><span data-stu-id="882ef-150">For more information about <xref:System.ServiceModel.Channels.ConnectionOrientedTransportBindingElement.ChannelInitializationTimeout%2A></span></span>|
|<span data-ttu-id="882ef-151">listenBacklog</span><span class="sxs-lookup"><span data-stu-id="882ef-151">listenBacklog</span></span>|<xref:System.ServiceModel.NetTcpBinding>|<span data-ttu-id="882ef-152">16 \* プロセッサの数</span><span class="sxs-lookup"><span data-stu-id="882ef-152">16 \* number of processors</span></span>|<span data-ttu-id="882ef-153">このソケット レベルのプロパティは、キューに入れられる "受入保留中の" 要求の数を示します。</span><span class="sxs-lookup"><span data-stu-id="882ef-153">This socket-level property describes the number of "pending accept" requests to be queued.</span></span> <span data-ttu-id="882ef-154">リッスン バックログ キューがいっぱいになると、新しいソケット要求は拒否されます。</span><span class="sxs-lookup"><span data-stu-id="882ef-154">If the listen backlog queue fills up, new socket requests will be rejected.</span></span> <span data-ttu-id="882ef-155">の詳細については、 <xref:System.ServiceModel.NetTcpBinding.ListenBacklog%2A></span><span class="sxs-lookup"><span data-stu-id="882ef-155">For more information about <xref:System.ServiceModel.NetTcpBinding.ListenBacklog%2A></span></span>|
|<span data-ttu-id="882ef-156">maxPendingAccepts</span><span class="sxs-lookup"><span data-stu-id="882ef-156">maxPendingAccepts</span></span>|<span data-ttu-id="882ef-157">ConnectionOrientedTransportBindingElement</span><span class="sxs-lookup"><span data-stu-id="882ef-157">ConnectionOrientedTransportBindingElement</span></span><br /><br /> <span data-ttu-id="882ef-158">SMSvcHost.exe</span><span class="sxs-lookup"><span data-stu-id="882ef-158">SMSvcHost.exe</span></span>|<span data-ttu-id="882ef-159">2 \* トランスポート用のプロセッサの数</span><span class="sxs-lookup"><span data-stu-id="882ef-159">2 \* number of processors for transport</span></span><br /><br /> <span data-ttu-id="882ef-160">4 \* SMSvcHost.exe のプロセッサ数</span><span class="sxs-lookup"><span data-stu-id="882ef-160">4 \* number of processors for SMSvcHost.exe</span></span>|<span data-ttu-id="882ef-161">このプロパティは、サーバーがリスナーで待機できるチャネルの数を制限します。</span><span class="sxs-lookup"><span data-stu-id="882ef-161">This property limits the number of channels that the server can have waiting on a listener.</span></span> <span data-ttu-id="882ef-162">MaxPendingAccepts が小さすぎると、待機しているすべてのチャネルが接続のサービスを開始する間隔が小さくなりますが、新しいチャネルがリッスンを開始できなくなります。</span><span class="sxs-lookup"><span data-stu-id="882ef-162">When MaxPendingAccepts is too low, there will be a small interval of time in which all of the waiting channels have started servicing connections, but no new channels have begun listening.</span></span> <span data-ttu-id="882ef-163">接続がこの間に到着した場合、サーバー上でこの接続を待機しているものがないため、接続は失敗します。</span><span class="sxs-lookup"><span data-stu-id="882ef-163">A connection can arrive during this interval and will fail because nothing is waiting for it on the server.</span></span> <span data-ttu-id="882ef-164">このプロパティは、<xref:System.ServiceModel.Channels.ConnectionOrientedTransportBindingElement.MaxPendingConnections%2A> プロパティを大きな値に設定することで構成できます。</span><span class="sxs-lookup"><span data-stu-id="882ef-164">This property can be configured by setting the <xref:System.ServiceModel.Channels.ConnectionOrientedTransportBindingElement.MaxPendingConnections%2A> property to a larger number.</span></span> <span data-ttu-id="882ef-165">詳細については、「」 <xref:System.ServiceModel.Channels.ConnectionOrientedTransportBindingElement.MaxPendingAccepts%2A> および「 [Net.tcp ポート共有サービスの構成](./feature-details/configuring-the-net-tcp-port-sharing-service.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="882ef-165">For more information, see <xref:System.ServiceModel.Channels.ConnectionOrientedTransportBindingElement.MaxPendingAccepts%2A> and [Configuring the Net.TCP Port Sharing Service](./feature-details/configuring-the-net-tcp-port-sharing-service.md)</span></span>|
|<span data-ttu-id="882ef-166">maxPendingConnections</span><span class="sxs-lookup"><span data-stu-id="882ef-166">maxPendingConnections</span></span>|<span data-ttu-id="882ef-167">ConnectionOrientedTransportBindingElement</span><span class="sxs-lookup"><span data-stu-id="882ef-167">ConnectionOrientedTransportBindingElement</span></span>|<span data-ttu-id="882ef-168">12 \* プロセッサの数</span><span class="sxs-lookup"><span data-stu-id="882ef-168">12 \* number of processors</span></span>|<span data-ttu-id="882ef-169">このプロパティは、トランスポートが受け入れたにもかかわらず ServiceModel ディスパッチャーによって取得されていない接続の数を制御します。</span><span class="sxs-lookup"><span data-stu-id="882ef-169">This property controls how many connections a transport has accepted but have not been picked up by the ServiceModel Dispatcher.</span></span> <span data-ttu-id="882ef-170">この値を設定するには、バインドの `MaxConnections` を使用するか、またはバインド要素の `maxOutboundConnectionsPerEndpoint` を使用してください。</span><span class="sxs-lookup"><span data-stu-id="882ef-170">To set this value, use `MaxConnections` on the binding or `maxOutboundConnectionsPerEndpoint` on the binding element.</span></span> <span data-ttu-id="882ef-171">の詳細については、 <xref:System.ServiceModel.Channels.ConnectionOrientedTransportBindingElement.MaxPendingConnections%2A></span><span class="sxs-lookup"><span data-stu-id="882ef-171">For more information about <xref:System.ServiceModel.Channels.ConnectionOrientedTransportBindingElement.MaxPendingConnections%2A></span></span>|
|<span data-ttu-id="882ef-172">receiveTimeout</span><span class="sxs-lookup"><span data-stu-id="882ef-172">receiveTimeout</span></span>|<span data-ttu-id="882ef-173">SMSvcHost.exe</span><span class="sxs-lookup"><span data-stu-id="882ef-173">SMSvcHost.exe</span></span>|<span data-ttu-id="882ef-174">30 秒</span><span class="sxs-lookup"><span data-stu-id="882ef-174">30 seconds</span></span>|<span data-ttu-id="882ef-175">このプロパティは、TCP フレーム データを読み取り、基になる接続からディスパッチする接続を実行するためのタイムアウトを指定します。</span><span class="sxs-lookup"><span data-stu-id="882ef-175">This property specifies the timeout for reading the TCP framing data and performing connection dispatching from the underlying connections.</span></span> <span data-ttu-id="882ef-176">これは、SMSvcHost.exe サービスで受信接続からの前文データの読み取り操作を行う時間に制限を設定するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="882ef-176">This exists to put a cap on the amount of time SMSvcHost.exe service is kept engaged to read the preamble data from an incoming connection.</span></span> <span data-ttu-id="882ef-177">詳細については、「 [Net.tcp ポート共有サービスの構成](./feature-details/configuring-the-net-tcp-port-sharing-service.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="882ef-177">For more information, see [Configuring the Net.TCP Port Sharing Service](./feature-details/configuring-the-net-tcp-port-sharing-service.md).</span></span>|

> [!NOTE]
> <span data-ttu-id="882ef-178">これらの新しい既定値は、.NET Framework 4.5 がインストールされているコンピューターに WCF サービスを配置する場合のみ使用されます。</span><span class="sxs-lookup"><span data-stu-id="882ef-178">These new defaults are used only if you deploy the WCF service on a machine with .NET Framework 4.5.</span></span> <span data-ttu-id="882ef-179">.NET Framework 4.0 がインストールされているコンピューターに同じサービスを配置すると、.NET Framework 4.0 の既定値が使用されます。</span><span class="sxs-lookup"><span data-stu-id="882ef-179">If you deploy the same service on a machine with .NET Framework 4.0, then the .NET Framework 4.0 defaults are used.</span></span> <span data-ttu-id="882ef-180">このような場合は、これらの設定を明示的に構成することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="882ef-180">In such cases it is recommended to configure these settings explicitly.</span></span>

## <a name="xmldictionaryreaderquotas"></a><span data-ttu-id="882ef-181">XmlDictionaryReaderQuotas</span><span class="sxs-lookup"><span data-stu-id="882ef-181">XmlDictionaryReaderQuotas</span></span>

<span data-ttu-id="882ef-182"><xref:System.Xml.XmlDictionaryReaderQuotas> には、メッセージの作成中にエンコーダーで使用されるメモリの量を制限する XML ディクショナリ リーダーの構成可能なクォータ値が格納されます。</span><span class="sxs-lookup"><span data-stu-id="882ef-182"><xref:System.Xml.XmlDictionaryReaderQuotas> contains configurable quota values for XML dictionary readers which limit the amount of memory utilized by an encoder while creating a message.</span></span> <span data-ttu-id="882ef-183">これらのクォータは構成可能ですが、開発者がこのクォータを明示的に設定する必要性を低くするために既定値が変更されました。</span><span class="sxs-lookup"><span data-stu-id="882ef-183">While these quotas are configurable, the default values have changed to lessen the possibility that a developer will need to set them explicitly.</span></span> <span data-ttu-id="882ef-184">`MaxReceivedMessageSize` クォータは変更されていないため、メモリ使用量を引き続き制限して、<xref:System.Xml.XmlDictionaryReaderQuotas> の複雑さを処理する必要性を回避できます。</span><span class="sxs-lookup"><span data-stu-id="882ef-184">`MaxReceivedMessageSize` quota has not been changed so that it can still limit memory consumption preventing the need for you to deal with the complexity of the <xref:System.Xml.XmlDictionaryReaderQuotas>.</span></span> <span data-ttu-id="882ef-185">次の表に、クォータ、クォータの新しい既定値、および各クォータの用途の簡単な説明を示します。</span><span class="sxs-lookup"><span data-stu-id="882ef-185">The following table shows the quotas, their new default values and a brief explanation of what each quota is used for.</span></span>

|<span data-ttu-id="882ef-186">クォータ名</span><span class="sxs-lookup"><span data-stu-id="882ef-186">Quota Name</span></span>|<span data-ttu-id="882ef-187">既定値</span><span class="sxs-lookup"><span data-stu-id="882ef-187">Default Value</span></span>|<span data-ttu-id="882ef-188">説明</span><span class="sxs-lookup"><span data-stu-id="882ef-188">Description</span></span>|
|----------------|-------------------|-----------------|
|<xref:System.Xml.XmlDictionaryReaderQuotas.MaxArrayLength%2A>|<span data-ttu-id="882ef-189">Int32.MaxValue</span><span class="sxs-lookup"><span data-stu-id="882ef-189">Int32.MaxValue</span></span>|<span data-ttu-id="882ef-190">許される最大配列長を取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="882ef-190">Gets and sets the maximum allowed array length.</span></span> <span data-ttu-id="882ef-191">このクォータは、XML リーダーが返すプリミティブ配列 (バイト配列など) の最大サイズを制限します。</span><span class="sxs-lookup"><span data-stu-id="882ef-191">This quota limits the maximum size of an array of primitives that the XML reader returns, including byte arrays.</span></span> <span data-ttu-id="882ef-192">このクォータは、XML リーダー自体のメモリ消費は制限しませんが、このリーダーを使用するコンポーネントのメモリ消費を制限します。</span><span class="sxs-lookup"><span data-stu-id="882ef-192">This quota does not limit memory consumption in the XML reader itself, but in whatever component that is using the reader.</span></span> <span data-ttu-id="882ef-193">たとえば、 <xref:System.Runtime.Serialization.DataContractSerializer> が <xref:System.Xml.XmlDictionaryReaderQuotas.MaxArrayLength%2A>でセキュリティ保護されたリーダーを使用するときは、このクォータを超えるバイト配列を逆シリアル化することはありません。</span><span class="sxs-lookup"><span data-stu-id="882ef-193">For example, when the <xref:System.Runtime.Serialization.DataContractSerializer> uses a reader secured with <xref:System.Xml.XmlDictionaryReaderQuotas.MaxArrayLength%2A>, it does not deserialize byte arrays larger than this quota.</span></span>|
|<xref:System.Xml.XmlDictionaryReaderQuotas.MaxBytesPerRead%2A>|<span data-ttu-id="882ef-194">Int32.MaxValue</span><span class="sxs-lookup"><span data-stu-id="882ef-194">Int32.MaxValue</span></span>|<span data-ttu-id="882ef-195">1 回の読み取りで返すことができる最大バイト数を取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="882ef-195">Gets and sets the maximum allowed bytes returned for each read.</span></span> <span data-ttu-id="882ef-196">このクォータは、要素の開始タグとその属性を読み取るときに、1 回の読み取り操作で読み取るバイト数を制限します </span><span class="sxs-lookup"><span data-stu-id="882ef-196">This quota limits the number of bytes that are read in a single Read operation when reading the element start tag and its attributes.</span></span> <span data-ttu-id="882ef-197">(ストリーミングを使用しない場合、要素名自体がクォータに照らし合わせてカウントされることはありません)。</span><span class="sxs-lookup"><span data-stu-id="882ef-197">(In non-streamed cases, the element name itself is not counted against the quota).</span></span> <span data-ttu-id="882ef-198">XML 属性が多すぎると、属性名は一意かどうかを確認する必要があるため、処理時間が大幅に増加する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="882ef-198">Having too many XML attributes may use up disproportionate processing time because attribute names have to be checked for uniqueness.</span></span> <span data-ttu-id="882ef-199"><xref:System.Xml.XmlDictionaryReaderQuotas.MaxBytesPerRead%2A> によってこの脅威を軽減できます。</span><span class="sxs-lookup"><span data-stu-id="882ef-199"><xref:System.Xml.XmlDictionaryReaderQuotas.MaxBytesPerRead%2A> mitigates this threat.</span></span>|
|<xref:System.Xml.XmlDictionaryReaderQuotas.MaxDepth%2A>|<span data-ttu-id="882ef-200">128 ノードの深さ</span><span class="sxs-lookup"><span data-stu-id="882ef-200">128 nodes deep</span></span>|<span data-ttu-id="882ef-201">このクォータは、XML 要素の入れ子の深さの最大値を制限します。</span><span class="sxs-lookup"><span data-stu-id="882ef-201">This quota limits the maximum nesting depth of XML elements.</span></span> <span data-ttu-id="882ef-202"><xref:System.Xml.XmlDictionaryReaderQuotas.MaxDepth%2A> は <xref:System.Xml.XmlDictionaryReaderQuotas.MaxBytesPerRead%2A>と相互に関係しています。リーダーは常に、現在の要素とそのすべての先祖に関するデータをメモリ内に維持します。このため、リーダーのメモリ消費の最大値は、この 2 つの設定値の積に比例します。</span><span class="sxs-lookup"><span data-stu-id="882ef-202"><xref:System.Xml.XmlDictionaryReaderQuotas.MaxDepth%2A> interacts with <xref:System.Xml.XmlDictionaryReaderQuotas.MaxBytesPerRead%2A>: the reader always keeps data in memory for the current element and all of its ancestors, so the maximum memory consumption of the reader is proportional to the product of these two settings.</span></span> <span data-ttu-id="882ef-203">深く入れ子になったオブジェクト グラフを逆シリアル化する場合、デシリアライザーはスタック全体にアクセスし、回復不可能な <xref:System.StackOverflowException>をスローするしかありません。</span><span class="sxs-lookup"><span data-stu-id="882ef-203">When deserializing a deeply-nested object graph, the deserializer is forced to access the entire stack and throw an unrecoverable <xref:System.StackOverflowException>.</span></span> <span data-ttu-id="882ef-204"><xref:System.Runtime.Serialization.DataContractSerializer> の場合も <xref:System.Xml.Serialization.XmlSerializer>の場合も、XML の入れ子構造とオブジェクトの入れ子構造との間に直接的な相関関係が存在します。</span><span class="sxs-lookup"><span data-stu-id="882ef-204">A direct correlation exists between XML nesting and object nesting for both the <xref:System.Runtime.Serialization.DataContractSerializer> and the <xref:System.Xml.Serialization.XmlSerializer>.</span></span> <span data-ttu-id="882ef-205">この脅威を軽減するには、<xref:System.Xml.XmlDictionaryReaderQuotas.MaxDepth%2A> を使用します。</span><span class="sxs-lookup"><span data-stu-id="882ef-205"><xref:System.Xml.XmlDictionaryReaderQuotas.MaxDepth%2A> is used to mitigate this threat.</span></span>|
|<xref:System.Xml.XmlDictionaryReaderQuotas.MaxNameTableCharCount%2A>|<span data-ttu-id="882ef-206">Int32.MaxValue</span><span class="sxs-lookup"><span data-stu-id="882ef-206">Int32.MaxValue</span></span>|<span data-ttu-id="882ef-207">このクォータは、nametable で使用できる最大文字数を制限します。</span><span class="sxs-lookup"><span data-stu-id="882ef-207">This quota limits the maximum number of characters allowed in a nametable.</span></span> <span data-ttu-id="882ef-208">nametable には、XML ドキュメントを処理するときに出現する特定の文字列 (名前空間やプレフィックスなど) が入っています。</span><span class="sxs-lookup"><span data-stu-id="882ef-208">The nametable contains certain strings (such as namespaces and prefixes) that are encountered when processing an XML document.</span></span> <span data-ttu-id="882ef-209">これらの文字列はメモリ内でバッファー化されるので、ストリーミングが予想されるときは、このクォータを使用して過度のバッファーを防止します。</span><span class="sxs-lookup"><span data-stu-id="882ef-209">As these strings are buffered in memory, this quota is used to prevent excessive buffering when streaming is expected.</span></span>|
|<xref:System.Xml.XmlDictionaryReaderQuotas.MaxStringContentLength%2A>|<span data-ttu-id="882ef-210">Int32.MaxValue</span><span class="sxs-lookup"><span data-stu-id="882ef-210">Int32.MaxValue</span></span>|<span data-ttu-id="882ef-211">このクォータは、XML リーダーが返す文字列の最大サイズを制限します。</span><span class="sxs-lookup"><span data-stu-id="882ef-211">This quota limits the maximum string size that the XML reader returns.</span></span> <span data-ttu-id="882ef-212">このクォータは、XML リーダー自体のメモリ消費は制限しませんが、このリーダーを使用するコンポーネントのメモリ消費を制限します。</span><span class="sxs-lookup"><span data-stu-id="882ef-212">This quota does not limit memory consumption in the XML reader itself, but in the component that is using the reader.</span></span> <span data-ttu-id="882ef-213">たとえば、 <xref:System.Runtime.Serialization.DataContractSerializer> が <xref:System.Xml.XmlDictionaryReaderQuotas.MaxStringContentLength%2A>でセキュリティ保護されたリーダーを使用するときは、このクォータを超える文字列を逆シリアル化することはありません。</span><span class="sxs-lookup"><span data-stu-id="882ef-213">For example, when the <xref:System.Runtime.Serialization.DataContractSerializer> uses a reader secured with <xref:System.Xml.XmlDictionaryReaderQuotas.MaxStringContentLength%2A>, it does not deserialize strings larger than this quota.</span></span>|

> [!IMPORTANT]
> <span data-ttu-id="882ef-214">データのセキュリティ保護の詳細については、「 [データのセキュリティに関する考慮事項](./feature-details/security-considerations-for-data.md) 」の「XML の安全な使用」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="882ef-214">Refer to "Using XML Safely" under [Security Considerations for Data](./feature-details/security-considerations-for-data.md) for more information about securing your data.</span></span>

> [!NOTE]
> <span data-ttu-id="882ef-215">これらの新しい既定値は、.NET Framework 4.5 がインストールされているコンピューターに WCF サービスを配置する場合のみ使用されます。</span><span class="sxs-lookup"><span data-stu-id="882ef-215">These new defaults are used only if you deploy the WCF service on a machine with .NET Framework 4.5.</span></span> <span data-ttu-id="882ef-216">.NET Framework 4.0 がインストールされているコンピューターに同じサービスを配置すると、.NET Framework 4.0 の既定値が使用されます。</span><span class="sxs-lookup"><span data-stu-id="882ef-216">If you deploy the same service on a machine with .NET Framework 4.0, then the .NET Framework 4.0 defaults are used.</span></span> <span data-ttu-id="882ef-217">このような場合は、これらの設定を明示的に構成することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="882ef-217">In such cases it is recommended to configure these settings explicitly.</span></span>

## <a name="wcf-configuration-validation"></a><span data-ttu-id="882ef-218">WCF 構成検証</span><span class="sxs-lookup"><span data-stu-id="882ef-218">WCF Configuration Validation</span></span>

<span data-ttu-id="882ef-219">Visual Studio 内でのビルド プロセスの一環として、WCF 構成ファイルが検証されるようになりました。</span><span class="sxs-lookup"><span data-stu-id="882ef-219">As part of the build process within Visual Studio, WCF configuration files are now validated.</span></span> <span data-ttu-id="882ef-220">検証に失敗すると、Visual Studio では検証エラーと警告の一覧が表示されます。</span><span class="sxs-lookup"><span data-stu-id="882ef-220">A list of validation errors or warnings are displayed in Visual Studio if the validation fails.</span></span>

## <a name="xml-editor-tooltips"></a><span data-ttu-id="882ef-221">XML エディターのツールヒント</span><span class="sxs-lookup"><span data-stu-id="882ef-221">XML Editor Tooltips</span></span>

<span data-ttu-id="882ef-222">新規および既存の WCF サービスの開発者がサービスを構成するうえで役立つよう、Visual Studio の XML エディターでは、サービス構成ファイルに含まれる各構成要素とそのプロパティにツールヒントが表示されるようになりました。</span><span class="sxs-lookup"><span data-stu-id="882ef-222">In order to help new and existing WCF service developers to configure their services, the Visual Studio XML editor now provides tooltips for every configuration element and its properties that is part of the service configuration file.</span></span>

## <a name="basichttpbinding-improvements"></a><span data-ttu-id="882ef-223">BasicHttpBinding の機能強化</span><span class="sxs-lookup"><span data-stu-id="882ef-223">BasicHttpBinding Improvements</span></span>

1. <span data-ttu-id="882ef-224">単一の WCF エンドポイントでさまざまな認証モードに応答できます。</span><span class="sxs-lookup"><span data-stu-id="882ef-224">Enables a single WCF endpoint to respond to different authentication modes.</span></span>

2. <span data-ttu-id="882ef-225">WCF サービスのセキュリティ設定を IIS で制御できます。</span><span class="sxs-lookup"><span data-stu-id="882ef-225">Enables a WCF service’s security settings to be controlled by IIS</span></span>
