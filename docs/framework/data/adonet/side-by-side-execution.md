---
description: '詳細情報: ADO.NET での side-by-side 実行'
title: side-by-side 実行
ms.date: 03/30/2017
ms.assetid: 9f9ba96d-9f89-4f65-bb2f-6860879f4393
ms.openlocfilehash: ab55430382f49c40a577d5cac8501c0136c9f0a4
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/06/2021
ms.locfileid: "99718773"
---
# <a name="side-by-side-execution-in-adonet"></a><span data-ttu-id="04141-103">ADO.NET での side-by-side 実行</span><span class="sxs-lookup"><span data-stu-id="04141-103">Side-by-Side Execution in ADO.NET</span></span>

<span data-ttu-id="04141-104">.NET Framework の side-by-side 実行は、.NET Framework の複数のバージョンがインストールされている 1 台のコンピューター上で、アプリケーションのコンパイル時のバージョンのみを使用して、アプリケーションを実行する機能です。</span><span class="sxs-lookup"><span data-stu-id="04141-104">Side-by-side execution in the .NET Framework is the ability to execute an application on a computer that has multiple versions of the .NET Framework installed, exclusively using the version for which the application was compiled.</span></span> <span data-ttu-id="04141-105">side-by-side 実行について詳しくは、[side-by-side 実行](../../deployment/side-by-side-execution.md)に関する記事をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="04141-105">For detailed information about configuring side-by-side execution, see [Side-by-Side Execution](../../deployment/side-by-side-execution.md).</span></span>  
  
 <span data-ttu-id="04141-106">あるバージョンの .NET Framework を使用してコンパイルされたアプリケーションを、別のバージョンの .NET Framework で実行することもできます。</span><span class="sxs-lookup"><span data-stu-id="04141-106">An application compiled by using one version of the .NET Framework can run on a different version of the .NET Framework.</span></span> <span data-ttu-id="04141-107">ただし、インストールされている .NET Framework のバージョンごとにアプリケーションをコンパイルして、各バージョンを別々に実行することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="04141-107">However, we recommend that you compile a version of the application for each installed version of the .NET Framework, and run them separately.</span></span> <span data-ttu-id="04141-108">いずれの場合でも、ADO.NET の各リリース間の変更によって生じるアプリケーションの上位互換性または下位互換性の問題に注意する必要があります。</span><span class="sxs-lookup"><span data-stu-id="04141-108">In either scenario, you should be aware of changes in ADO.NET between releases that can affect the forward compatibility or backward compatibility of your application.</span></span>  
  
## <a name="forward-compatibility-and-backward-compatibility"></a><span data-ttu-id="04141-109">上位互換性と下位互換性</span><span class="sxs-lookup"><span data-stu-id="04141-109">Forward Compatibility and Backward Compatibility</span></span>  

 <span data-ttu-id="04141-110">上位互換性とは、.NET Framework の旧バージョンでコンパイルしたアプリケーションが、新しいバージョンの .NET Framework でも実行できることを意味します。</span><span class="sxs-lookup"><span data-stu-id="04141-110">Forward compatibility means that an application can be compiled with an earlier version of the .NET Framework, but will still run successfully on a later version of the .NET Framework.</span></span> <span data-ttu-id="04141-111">.NET Framework バージョン 1.1 用に書かれた ADO.NET のコードは、後のバージョンとの上位互換性があります。</span><span class="sxs-lookup"><span data-stu-id="04141-111">ADO.NET code written for the .NET Framework version 1.1 is forward compatible with later versions.</span></span>  
  
 <span data-ttu-id="04141-112">下位互換性とは、アプリケーションが新しいバージョンの .NET Framework 用にコンパイルされていても、機能を低下させずに、.NET Framework の以前のバージョンで引き続き実行できることを意味します。</span><span class="sxs-lookup"><span data-stu-id="04141-112">Backward compatibility means that an application is compiled for a newer version of the .NET Framework, but continues to run on earlier versions of the .NET Framework without any loss of functionality.</span></span> <span data-ttu-id="04141-113">当然のことながら、.NET Framework の新しいバージョンで導入された機能については、これは該当しません。</span><span class="sxs-lookup"><span data-stu-id="04141-113">Of course, this will not be the case for features introduced in a new version of the .NET Framework.</span></span>  
  
## <a name="the-net-framework-data-provider-for-odbc"></a><span data-ttu-id="04141-114">.NET Framework Data Provider for ODBC</span><span class="sxs-lookup"><span data-stu-id="04141-114">The .NET Framework Data Provider for ODBC</span></span>  

 <span data-ttu-id="04141-115">バージョン 1.1 以降の .NET Framework には、.NET Framework Data Provider for ODBC (<xref:System.Data.Odbc>) が含まれています。</span><span class="sxs-lookup"><span data-stu-id="04141-115">Starting with version 1.1, the .NET Framework Data Provider for ODBC (<xref:System.Data.Odbc>) is included as a part of the .NET Framework.</span></span>
  
 <span data-ttu-id="04141-116">ODBC データ プロバイダーを使用してデータ ソースに接続する、.NET Framework バージョン 1.0 用に開発されたアプリケーションを、.NET Framework バージョン 1.1 以降で実行する場合は、ODBC データ プロバイダーの名前空間を **System.Data.Odbc** に更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="04141-116">If you have an application developed for the .NET Framework version 1.0 that uses the ODBC data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.1 or a later version, you must update the namespace for the ODBC data provider to **System.Data.Odbc**.</span></span> <span data-ttu-id="04141-117">その後で、.NET Framework の新しいバージョン用に再コンパイルする必要があります。</span><span class="sxs-lookup"><span data-stu-id="04141-117">You then must recompile it for the newer version of the .NET Framework.</span></span>  
  
 <span data-ttu-id="04141-118">ODBC データ プロバイダーを使用してデータ ソースに接続する .NET Framework バージョン 2.0 以降用に開発されたアプリケーションを、.NET Framework バージョン 1.0 で実行する場合は、ODBC データ プロバイダーをダウンロードし、.NET Framework バージョン 1.0 システムにインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="04141-118">If you have an application developed for the .NET Framework version 2.0 or later that uses the ODBC data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.0, you must download the ODBC data provider and install it on the .NET Framework version 1.0 system.</span></span> <span data-ttu-id="04141-119">次に、ODBC データ プロバイダーの名前空間を **Microsoft.Data.Odbc** に変更し、アプリケーションを .NET Framework バージョン 1.0 用に再コンパイルする必要があります。</span><span class="sxs-lookup"><span data-stu-id="04141-119">You then must change the namespace for the ODBC data provider to **Microsoft.Data.Odbc**, and recompile the application for the .NET Framework version 1.0.</span></span>  
  
## <a name="the-net-framework-data-provider-for-oracle"></a><span data-ttu-id="04141-120">.NET Framework Data Provider for Oracle</span><span class="sxs-lookup"><span data-stu-id="04141-120">The .NET Framework Data Provider for Oracle</span></span>  

 <span data-ttu-id="04141-121">バージョン 1.1 以降の .NET Framework には、.NET Framework Data Provider for Oracle (<xref:System.Data.OracleClient>) が含まれています。</span><span class="sxs-lookup"><span data-stu-id="04141-121">Starting with version 1.1, the .NET Framework Data Provider for Oracle (<xref:System.Data.OracleClient>) is included as a part of the .NET Framework.</span></span>
  
 <span data-ttu-id="04141-122">データ プロバイダーを使用してデータ ソースに接続する .NET Framework バージョン 2.0 以降用に開発されたアプリケーションを、.NET Framework バージョン 1.0 で実行する場合は、データ プロバイダーをダウンロードし、.NET Framework バージョン 1.0 システムにインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="04141-122">If you have an application developed for the .NET Framework version 2.0 or later that uses the data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.0, you must download the data provider and install it on the .NET Framework version 1.0 system.</span></span>  
  
## <a name="code-access-security"></a><span data-ttu-id="04141-123">コード アクセス セキュリティ</span><span class="sxs-lookup"><span data-stu-id="04141-123">Code Access Security</span></span>  

 <span data-ttu-id="04141-124">.NET Framework バージョン 1.0 の .NET Framework データ プロバイダー (<xref:System.Data.SqlClient>、<xref:System.Data.OleDb>) を実行するには、FullTrust アクセス許可が必要です。</span><span class="sxs-lookup"><span data-stu-id="04141-124">The .NET Framework data providers in the .NET Framework version 1.0 (<xref:System.Data.SqlClient>, <xref:System.Data.OleDb>) are required to run with FullTrust permission.</span></span> <span data-ttu-id="04141-125">アクセス許可レベルが FullTrust より低いゾーンで .NET Framework バージョン 1.0 の .NET Framework データ プロバイダーを使用しようとすると、<xref:System.Security.SecurityException> が発生します。</span><span class="sxs-lookup"><span data-stu-id="04141-125">Any attempt to use the .NET Framework k data providers from the .NET Framework version 1.0 in a zone with less than FullTrust permission causes a <xref:System.Security.SecurityException>.</span></span>  
  
 <span data-ttu-id="04141-126">ただし、.NET Framework バージョン 2.0 以降では、部分的に信頼されたゾーンですべての .NET Framework データ プロバイダーを使用できるようになりました。</span><span class="sxs-lookup"><span data-stu-id="04141-126">However, starting with the .NET Framework version 2.0, all of the .NET Framework data providers can be used in partially trusted zones.</span></span> <span data-ttu-id="04141-127">さらに、.NET Framework バージョン 1.1 の .NET Framework データ プロバイダーには、新しいセキュリティ機能が追加されました。</span><span class="sxs-lookup"><span data-stu-id="04141-127">In addition, a new security feature was added to the .NET Framework data providers in the .NET Framework version 1.1.</span></span> <span data-ttu-id="04141-128">この機能により、特定のセキュリティ ゾーンで使用できる接続文字列を制限することができます。</span><span class="sxs-lookup"><span data-stu-id="04141-128">This feature enables you to restrict what connection strings can be used in a particular security zone.</span></span> <span data-ttu-id="04141-129">特定のセキュリティ ゾーンに対して空白のパスワードの使用を禁止することもできます。</span><span class="sxs-lookup"><span data-stu-id="04141-129">You can also disable the use of blank passwords for a particular security zone.</span></span> <span data-ttu-id="04141-130">詳細については、「 [Code Access Security and ADO.NET](code-access-security.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="04141-130">For more information, see [Code Access Security and ADO.NET](code-access-security.md).</span></span>  
  
 <span data-ttu-id="04141-131">.NET Framework のインストールごとに個別の Security.config ファイルがあるため、セキュリティ設定については、互換性の問題はありません。</span><span class="sxs-lookup"><span data-stu-id="04141-131">Because each installation of the .NET Framework has a separate Security.config file, there are no compatibility issues with security settings.</span></span> <span data-ttu-id="04141-132">ただし、アプリケーションが、.NET Framework バージョン 1.1 以降に含まれる ADO.NET の追加のセキュリティ機能に依存している場合は、アプリケーションをバージョン 1.0 のシステムに配布することはできません。</span><span class="sxs-lookup"><span data-stu-id="04141-132">However, if your application depends on the additional security capabilities of ADO.NET included in the .NET Framework version 1.1 and later, you will not be able to distribute it to a version 1.0 system.</span></span>  
  
## <a name="sqlcommand-execution"></a><span data-ttu-id="04141-133">SqlCommand の実行</span><span class="sxs-lookup"><span data-stu-id="04141-133">SqlCommand Execution</span></span>  

 <span data-ttu-id="04141-134">.NET Framework バージョン 1.1 以降では、<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> によるデータ ソースでのコマンドの実行方法が変更されました。</span><span class="sxs-lookup"><span data-stu-id="04141-134">Starting with the .NET Framework version 1.1, the way that <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executes commands at the data source was changed.</span></span>  
  
 <span data-ttu-id="04141-135">.NET Framework バージョン 1.0 の <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> では、すべてのコマンドが **sp_executesql** ストアド プロシージャのコンテキストで実行されました。</span><span class="sxs-lookup"><span data-stu-id="04141-135">In the .NET Framework version 1.0, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executed all commands in the context of the **sp_executesql** stored procedure.</span></span> <span data-ttu-id="04141-136">その結果、接続の状態に影響を与えるコマンド (たとえば、SET NOCOUNT ON) は、現在のコマンドの実行だけに適用されます。</span><span class="sxs-lookup"><span data-stu-id="04141-136">As a result, commands that affect the state of the connection (for example, SET NOCOUNT ON), only apply to the execution of the current command.</span></span> <span data-ttu-id="04141-137">接続が開かれている間に実行される後続のコマンドについては、接続の状態は変更されません。</span><span class="sxs-lookup"><span data-stu-id="04141-137">The state of the connection is not modified for any subsequent commands executed while the connection is open.</span></span>  
  
 <span data-ttu-id="04141-138">.NET Framework バージョン 1.1 以降の <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> では、コマンドにパラメーターが含まれている場合にのみ、コマンドは **sp_executesql** ストアド プロシージャのコンテキストで実行されます。これにより、パフォーマンスが向上します。</span><span class="sxs-lookup"><span data-stu-id="04141-138">In the .NET Framework version 1.1 and later, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> only executes a command in the context of the **sp_executesql** stored procedure if the command contains parameters, which provides a performance benefit.</span></span> <span data-ttu-id="04141-139">その結果、接続の状態に影響を与えるコマンドが、非パラメーター化コマンドに含まれている場合、接続が開いている間に実行される後続のすべてのコマンドに対して、接続の状態を変更します。</span><span class="sxs-lookup"><span data-stu-id="04141-139">As a result, if a command affecting the state of the connection is included in a non-parameterized command, it modifies the state of the connection for all subsequent commands executed while the connection is open.</span></span>  
  
 <span data-ttu-id="04141-140">たとえば、<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> への呼び出しで次のバッチ コマンドが実行されるとします。</span><span class="sxs-lookup"><span data-stu-id="04141-140">Consider the following batch of commands executed in a call to <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>.</span></span>  
  
```sql
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
```  
  
 <span data-ttu-id="04141-141">.NET Framework バージョン 1.1 以降では、接続が開かれている間に実行される後続のすべてのコマンドに対して、NOCOUNT は ON のままになります。</span><span class="sxs-lookup"><span data-stu-id="04141-141">In the .NET Framework version 1.1 and later, NOCOUNT will remain ON for any subsequent commands executed while the connection is open.</span></span> <span data-ttu-id="04141-142">.NET Framework バージョン 1.0 では、NOCOUNT は現在のコマンドの実行に対してだけ ON です。</span><span class="sxs-lookup"><span data-stu-id="04141-142">In the .NET Framework version 1.0, NOCOUNT is only ON for the current command execution.</span></span>  
  
 <span data-ttu-id="04141-143">アプリケーションが、いずれかのバージョンの .NET Framework の <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> の動作に依存している場合、この変更が上位互換性と下位互換性の両方に影響することがあります。</span><span class="sxs-lookup"><span data-stu-id="04141-143">This change can affect both the forward and backward compatibility of your application if you depend on the behavior of <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> for either version of the .NET Framework.</span></span>  
  
 <span data-ttu-id="04141-144">アプリケーションが新旧両方のバージョンの .NET Framework で実行する場合は、どのバージョンで実行された場合にも動作が同じになるように、コードを記述できます。</span><span class="sxs-lookup"><span data-stu-id="04141-144">For applications that run on both earlier and later versions of the .NET Framework, you can write your code to make sure that the behavior is the same regardless of the version you are running on.</span></span> <span data-ttu-id="04141-145">変更された接続状態が後続のすべてのコマンドでも有効になるようにする場合は、<xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A> を使用してコマンドを実行することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="04141-145">If you want to make sure that a command modifies the state of the connection for all subsequent commands, we recommend that you execute your command using <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A>.</span></span> <span data-ttu-id="04141-146">変更された接続状態が後続のコマンドでは無効になるようにする場合は、接続状態をリセットするコマンドを含めるようにしてください。</span><span class="sxs-lookup"><span data-stu-id="04141-146">If you want to make sure that a command does not modify the connection for all subsequent commands, we recommend that you include the commands to reset the state of the connection in your command.</span></span> <span data-ttu-id="04141-147">次に例を示します。</span><span class="sxs-lookup"><span data-stu-id="04141-147">For example:</span></span>  
  
```sql
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
SET NOCOUNT OFF;  
```  
  
## <a name="see-also"></a><span data-ttu-id="04141-148">関連項目</span><span class="sxs-lookup"><span data-stu-id="04141-148">See also</span></span>

- [<span data-ttu-id="04141-149">ADO.NET の概要</span><span class="sxs-lookup"><span data-stu-id="04141-149">ADO.NET Overview</span></span>](ado-net-overview.md)
- [<span data-ttu-id="04141-150">ADO.NET でのデータの取得および変更</span><span class="sxs-lookup"><span data-stu-id="04141-150">Retrieving and Modifying Data in ADO.NET</span></span>](retrieving-and-modifying-data.md)
