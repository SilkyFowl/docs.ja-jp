---
description: '詳細情報: 単一テーブルのクエリ (LINQ to DataSet)'
title: 単一テーブルのクエリ (LINQ to DataSet)
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 0b74bcf8-3f87-449f-bff7-6bcb0d69d212
ms.openlocfilehash: a4b6ce2a60eeafc9221d838d1b86c9964774df60
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/06/2021
ms.locfileid: "99718760"
---
# <a name="single-table-queries-linq-to-dataset"></a><span data-ttu-id="f6776-103">単一テーブルのクエリ (LINQ to DataSet)</span><span class="sxs-lookup"><span data-stu-id="f6776-103">Single-Table Queries (LINQ to DataSet)</span></span>

<span data-ttu-id="f6776-104">LINQ (統合言語クエリ) のクエリは、<xref:System.Collections.Generic.IEnumerable%601> インターフェイスまたは <xref:System.Linq.IQueryable%601> インターフェイスが実装されているデータ ソースに対して動作します。</span><span class="sxs-lookup"><span data-stu-id="f6776-104">Language-Integrated Query (LINQ) queries work on data sources that implement the <xref:System.Collections.Generic.IEnumerable%601> interface or the <xref:System.Linq.IQueryable%601> interface.</span></span> <span data-ttu-id="f6776-105"><xref:System.Data.DataTable> クラスには、いずれのインターフェイスも実装されていません。そのため、LINQ クエリの `From` 句でソースとして <xref:System.Data.DataTable> を使用する場合は、<xref:System.Data.DataTableExtensions.AsEnumerable%2A> メソッドを呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="f6776-105">The <xref:System.Data.DataTable> class does not implement either interface, so you must call the <xref:System.Data.DataTableExtensions.AsEnumerable%2A> method if you want to use the <xref:System.Data.DataTable> as a source in the `From` clause of a LINQ query.</span></span>  
  
 <span data-ttu-id="f6776-106">次の例では、SalesOrderHeader テーブルからオンラインでの注文をすべて取得し、注文 ID、注文日、および注文番号をコンソールに出力します。</span><span class="sxs-lookup"><span data-stu-id="f6776-106">The following example gets all the online orders from the SalesOrderHeader table and outputs the order ID, order date, and order number to the console.</span></span>  
  
 [!code-csharp[DP LINQ to DataSet Examples#Where1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#where1)]  
 [!code-vb[DP LINQ to DataSet Examples#Where1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#where1)]
  
 <span data-ttu-id="f6776-107">ローカル変数 query はクエリ式で初期化されます。クエリ式は、少なくとも 1 つのクエリ演算子 (標準クエリ演算子、LINQ to DataSet の場合は <xref:System.Data.DataSet> クラスに固有の演算子) が適用されることによって、1 つまたは複数の情報ソースに対して機能します。</span><span class="sxs-lookup"><span data-stu-id="f6776-107">The local variable query is initialized with a query expression, which operates on one or more information sources by applying one or more query operators from either the standard query operators or, in the case of LINQ to DataSet, operators specific to the <xref:System.Data.DataSet> class.</span></span> <span data-ttu-id="f6776-108">前の例のクエリ式には、2 つの標準クエリ演算子、`Where` と `Select` が使用されています。</span><span class="sxs-lookup"><span data-stu-id="f6776-108">The query expression in the previous example uses two of the standard query operators: `Where` and `Select`.</span></span>  
  
 <span data-ttu-id="f6776-109">この場合、`Where` 句では、`OnlineOrderFlag` = `true` という条件に基づいてデータを抽出します。</span><span class="sxs-lookup"><span data-stu-id="f6776-109">The `Where` clause filters the sequence based on a condition, in this case that the `OnlineOrderFlag` is set to `true`.</span></span> <span data-ttu-id="f6776-110">`Select` 演算子は、その演算子に渡された引数をキャプチャする列挙可能なオブジェクトを割り当てて返します。</span><span class="sxs-lookup"><span data-stu-id="f6776-110">The `Select` operator allocates and returns an enumerable object that captures the arguments passed to the operator.</span></span> <span data-ttu-id="f6776-111">上の例では、`SalesOrderID`、`OrderDate`、`SalesOrderNumber` の 3 つのプロパティを使って匿名型を作成しています。</span><span class="sxs-lookup"><span data-stu-id="f6776-111">In this above example, an anonymous type is created with three properties: `SalesOrderID`, `OrderDate`, and `SalesOrderNumber`.</span></span> <span data-ttu-id="f6776-112">この 3 つのプロパティの値は、`SalesOrderID` テーブルの `OrderDate` 列、`SalesOrderNumber` 列、および `SalesOrderHeader` 列の値に設定されます。</span><span class="sxs-lookup"><span data-stu-id="f6776-112">The values of these three properties are set to the values of the `SalesOrderID`, `OrderDate`, and `SalesOrderNumber` columns from the `SalesOrderHeader` table.</span></span>  
  
 <span data-ttu-id="f6776-113">次に、`foreach` から返された列挙可能なオブジェクトを `Select` ループで列挙し、クエリ結果を出力します。</span><span class="sxs-lookup"><span data-stu-id="f6776-113">The `foreach` loop then enumerates the enumerable object returned by `Select` and yields the query results.</span></span> <span data-ttu-id="f6776-114">クエリは <xref:System.Linq.Enumerable> を実装する <xref:System.Collections.Generic.IEnumerable%601> 型であるため、`foreach` ループでクエリ変数を反復処理するまでクエリは評価されません。</span><span class="sxs-lookup"><span data-stu-id="f6776-114">Because query is an <xref:System.Linq.Enumerable> type, which implements <xref:System.Collections.Generic.IEnumerable%601>, the evaluation of the query is deferred until the query variable is iterated over using the `foreach` loop.</span></span> <span data-ttu-id="f6776-115">クエリの評価を遅らせることで、繰り返し評価することのできる値としてクエリを維持し、評価のたびに異なる結果を得ることができます。</span><span class="sxs-lookup"><span data-stu-id="f6776-115">Deferred query evaluation allows queries to be kept as values that can be evaluated multiple times, each time yielding potentially different results.</span></span>  
  
 <span data-ttu-id="f6776-116"><xref:System.Data.DataRowExtensions.Field%2A> は、<xref:System.Data.DataRow> の列値にアクセスするためのメソッドです。また、前出の例には使用されていませんが、<xref:System.Data.DataRowExtensions.SetField%2A> を使用すると、<xref:System.Data.DataRow> の列値を設定できます。</span><span class="sxs-lookup"><span data-stu-id="f6776-116">The <xref:System.Data.DataRowExtensions.Field%2A> method provides access to the column values of a <xref:System.Data.DataRow> and the <xref:System.Data.DataRowExtensions.SetField%2A> (not shown in the previous example) sets column values in a <xref:System.Data.DataRow>.</span></span> <span data-ttu-id="f6776-117"><xref:System.Data.DataRowExtensions.Field%2A> メソッドも <xref:System.Data.DataRowExtensions.SetField%2A> メソッドも null 許容値型を扱うことができるため、null 値を明示的にチェックする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="f6776-117">Both the <xref:System.Data.DataRowExtensions.Field%2A> method and <xref:System.Data.DataRowExtensions.SetField%2A> method handle nullable value types, so you do not have to explicitly check for null values.</span></span> <span data-ttu-id="f6776-118">また、どちらのメソッドもジェネリック メソッドです。つまり、戻り値の型をキャストする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="f6776-118">Both methods are generic methods, also, which means you do not have to cast the return type.</span></span> <span data-ttu-id="f6776-119"><xref:System.Data.DataRow> の既存の列アクセサー (`o["OrderDate"]` など) を使用することもできますが、その場合、返されたオブジェクトを適切な型にキャストする必要があります。</span><span class="sxs-lookup"><span data-stu-id="f6776-119">You could use the pre-existing column accessor in <xref:System.Data.DataRow> (for example, `o["OrderDate"]`), but doing so would require you to cast the return object to the appropriate type.</span></span>  <span data-ttu-id="f6776-120">列が null 許容値型である場合、<xref:System.Data.DataRow.IsNull%2A> メソッドを使って、値が null かどうかをチェックする必要があります。</span><span class="sxs-lookup"><span data-stu-id="f6776-120">If the column is a nullable value type you have to check if the value is null by using the <xref:System.Data.DataRow.IsNull%2A> method.</span></span> <span data-ttu-id="f6776-121">詳細については、「[ジェネリック メソッド Field および SetField](generic-field-and-setfield-methods-linq-to-dataset.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f6776-121">For more information, see [Generic Field and SetField Methods](generic-field-and-setfield-methods-linq-to-dataset.md).</span></span>  
  
 <span data-ttu-id="f6776-122">`T` メソッドおよび <xref:System.Data.DataRowExtensions.Field%2A> メソッドのジェネリック パラメーター <xref:System.Data.DataRowExtensions.SetField%2A> に指定するデータ型は、基になる値の型と一致している必要があります。一致していない場合、<xref:System.InvalidCastException> がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f6776-122">Note that the data type specified in the generic parameter `T` of the <xref:System.Data.DataRowExtensions.Field%2A> method and <xref:System.Data.DataRowExtensions.SetField%2A> method must match the type of the underlying value or an <xref:System.InvalidCastException> will be thrown.</span></span> <span data-ttu-id="f6776-123">指定する列の名前も <xref:System.Data.DataSet> 内の列名と一致している必要があります。一致していない場合、<xref:System.ArgumentException> がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f6776-123">The specified column name must also match the name of a column in the <xref:System.Data.DataSet> or an <xref:System.ArgumentException> will be thrown.</span></span> <span data-ttu-id="f6776-124">どちらの場合も、例外は、実行時にデータが列挙されて、クエリが実行されたときにスローされます。</span><span class="sxs-lookup"><span data-stu-id="f6776-124">In both cases, the exception is thrown at run time data enumeration when the query is executed.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f6776-125">関連項目</span><span class="sxs-lookup"><span data-stu-id="f6776-125">See also</span></span>

- [<span data-ttu-id="f6776-126">複数テーブルにまたがるクエリ</span><span class="sxs-lookup"><span data-stu-id="f6776-126">Cross-Table Queries</span></span>](cross-table-queries-linq-to-dataset.md)
- [<span data-ttu-id="f6776-127">型指定された DataSet のクエリ</span><span class="sxs-lookup"><span data-stu-id="f6776-127">Querying Typed DataSets</span></span>](querying-typed-datasets.md)
- [<span data-ttu-id="f6776-128">ジェネリック メソッド Field および SetField</span><span class="sxs-lookup"><span data-stu-id="f6776-128">Generic Field and SetField Methods</span></span>](generic-field-and-setfield-methods-linq-to-dataset.md)
