---
description: '詳細情報: WCF Data Services のセキュリティ保護'
title: WCF Data Services のセキュリティ保護
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- securing application [WCF Data Services]
- WCF Data Services, security
ms.assetid: 99fc2baa-a040-4549-bc4d-f683d60298af
ms.openlocfilehash: c7f8cb989c33df3d124a1745046ea68cb27e8c2f
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/06/2021
ms.locfileid: "99773109"
---
# <a name="securing-wcf-data-services"></a><span data-ttu-id="2f5c6-103">WCF Data Services のセキュリティ保護</span><span class="sxs-lookup"><span data-stu-id="2f5c6-103">Securing WCF Data Services</span></span>

[!INCLUDE [wcf-deprecated](~/includes/wcf-deprecated.md)]

<span data-ttu-id="2f5c6-104">この記事では、WCF Data Services と、Open Data Protocol (OData) をサポートするサービスにアクセスするアプリケーションの開発、配置、および実行に特有のセキュリティの注意点について説明します。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-104">This article describes security considerations that are specific to developing, deploying, and running WCF Data Services and applications that access services that support the Open Data Protocol (OData).</span></span> <span data-ttu-id="2f5c6-105">安全な .NET Framework アプリケーションの作成に関する推奨事項にも従う必要があります。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-105">You should also follow recommendations for creating secure .NET Framework applications.</span></span>  
  
<span data-ttu-id="2f5c6-106">WCF Data Services ベースの OData サービスをセキュリティで保護する方法を計画するときには、認証 (プリンシパルの ID を発見および確認するプロセス) と承認 (認証されたプリンシパルが要求されたリソースにアクセスできるかどうかを判断するプロセス) の両方を解決する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-106">When planning how to secure a WCF Data Services-based OData service, you must address both authentication, the process of discovering and verifying the identity of a principal, and authorization, the process of determining whether an authenticated principal is allowed to access the requested resources.</span></span> <span data-ttu-id="2f5c6-107">また、SSL を使用してメッセージを暗号化するかどうかを検討します。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-107">Also consider whether to encrypt the message by using SSL.</span></span>  
  
## <a name="authenticating-client-requests"></a><span data-ttu-id="2f5c6-108">クライアント要求の認証</span><span class="sxs-lookup"><span data-stu-id="2f5c6-108">Authenticating Client Requests</span></span>  

<span data-ttu-id="2f5c6-109">WCF Data Services は、認証を独自に実装する代わりにデータ サービス ホストに依存しています。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-109">WCF Data Services does not implement any kind of authentication of its own, but rather relies on the authentication provisions of the data service host.</span></span> <span data-ttu-id="2f5c6-110">したがって、ネットワーク ホストによって受信要求が既に認証されていること、WCF Data Services によって提供されるインターフェイスを使用して要求のプリンシパルが正しく識別されていることが前提とされます。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-110">This means that the service assumes that any request that it receives has already been authenticated by the network host and that the host has correctly identified the principle for the request appropriately via the interfaces provided by WCF Data Services.</span></span> <span data-ttu-id="2f5c6-111">これらの認証オプションと方法の詳細については、[OData と認証に関する複数パートの記事](https://devblogs.microsoft.com/odata/?s=%22OData+and+authentication%22)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-111">These authentication options and approaches are detailed in the multipart [OData and Authentication series](https://devblogs.microsoft.com/odata/?s=%22OData+and+authentication%22).</span></span>  
  
### <a name="authentication-options-for-a-wcf-data-service"></a><span data-ttu-id="2f5c6-112">WCF Data Service の認証オプション</span><span class="sxs-lookup"><span data-stu-id="2f5c6-112">Authentication Options for a WCF Data Service</span></span>  

 <span data-ttu-id="2f5c6-113">次の表に、WCF Data Service への要求を認証するために使用できる認証メカニズムを示します。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-113">The following table lists some of the authentication mechanisms that are available to help you authenticate requests to a WCF Data Service.</span></span>  
  
|<span data-ttu-id="2f5c6-114">認証オプション</span><span class="sxs-lookup"><span data-stu-id="2f5c6-114">Authentication Options</span></span>|<span data-ttu-id="2f5c6-115">説明</span><span class="sxs-lookup"><span data-stu-id="2f5c6-115">Description</span></span>|  
|----------------------------|-----------------|  
|<span data-ttu-id="2f5c6-116">匿名認証</span><span class="sxs-lookup"><span data-stu-id="2f5c6-116">Anonymous authentication</span></span>|<span data-ttu-id="2f5c6-117">匿名 HTTP 認証が有効になっている場合は、すべてのプリンシパルがデータ サービスに接続できます。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-117">When HTTP anonymous authentication is enabled, any principle is able to connect to the data service.</span></span> <span data-ttu-id="2f5c6-118">匿名アクセスには資格情報は必要ありません。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-118">Credentials are not required for anonymous access.</span></span> <span data-ttu-id="2f5c6-119">このオプションは、だれでもデータ サービスにアクセスできるようにする場合にのみ使用します。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-119">Use this option only when you want to allow anyone to access the data service.</span></span>|  
|<span data-ttu-id="2f5c6-120">基本認証とダイジェスト認証</span><span class="sxs-lookup"><span data-stu-id="2f5c6-120">Basic and digest authentication</span></span>|<span data-ttu-id="2f5c6-121">ユーザー名とパスワードで構成される資格情報が認証に必要です。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-121">Credentials consisting of a user name and password are required for authentication.</span></span> <span data-ttu-id="2f5c6-122">Windows 以外のクライアントの認証がサポートされます。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-122">Supports authentication of non-Windows clients.</span></span> <span data-ttu-id="2f5c6-123">**セキュリティに関するメモ:** 基本認証の資格情報 (ユーザー名とパスワード) はクリア テキストで送信されるので、傍受される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-123">**Security Note:**  Basic authentication credentials (user name and password) are sent in the clear and can be intercepted.</span></span> <span data-ttu-id="2f5c6-124">ダイジェスト認証では、指定された資格情報に基づくハッシュが送信されるため、基本認証に比べて安全です。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-124">Digest authentication sends a hash based-on the supplied credentials, which makes it more secure than basic authentication.</span></span> <span data-ttu-id="2f5c6-125">ただし、どちらの方法も man-in-the-middle 攻撃を受ける可能性があります。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-125">Both are susceptible to man-in-the-middle attacks.</span></span> <span data-ttu-id="2f5c6-126">これらの認証方法を使用する場合は、SSL (Secure Sockets Layer) を使用してクライアントとデータ サービスの間の通信を暗号化することを検討してください。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-126">When using these authentication methods, you should consider encrypting communication between client and the data service by using the Secure Sockets Layer (SSL).</span></span> <br /><br /> <span data-ttu-id="2f5c6-127">Microsoft インターネット インフォメーション サービス (IIS) には、ASP.NET アプリケーションの HTTP 要求に対する基本認証とダイジェスト認証の実装が用意されています。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-127">Microsoft Internet Information Services (IIS) provides an implementation of both basic and digest authentication for HTTP requests in an ASP.NET application.</span></span> <span data-ttu-id="2f5c6-128">この Windows 認証プロバイダーの実装を使用すると、.NET Framework クライアント アプリケーションで、資格情報を要求の HTTP ヘッダーでデータ サービスに渡して Windows ユーザーの認証をシームレスにネゴシエートできます。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-128">This Windows Authentication Provider implementation enables a .NET Framework client application to supply credentials in the HTTP header of the request to the data service to seamlessly negotiate authentication of a Windows user.</span></span> <span data-ttu-id="2f5c6-129">詳細については、「[ダイジェスト認証のテクニカル リファレンス](/previous-versions/windows/it-pro/windows-server-2003/cc782794(v=ws.10))」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-129">For more information, see [Digest Authentication Technical Reference](/previous-versions/windows/it-pro/windows-server-2003/cc782794(v=ws.10)).</span></span><br /><br /> <span data-ttu-id="2f5c6-130">データ サービスで Windows 資格情報以外のカスタム認証サービスに基づく基本認証を使用する場合は、認証用のカスタム ADP.NET HTTP モジュールを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-130">When you want to have your data service use basic authentication based on some custom authentication service and not Windows credentials, you must implement a custom ADP.NET HTTP Module for authentication.</span></span><br /><br /> <span data-ttu-id="2f5c6-131">WCF Data Services でカスタム基本認証スキームを使用する方法の例については、ブログ記事「[OData と認証の – パート 6 – カスタム基本認証](https://devblogs.microsoft.com/odata/odata-and-authentication-part-6-custom-basic-authentication/)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-131">For an example of how to use a custom basic authentication scheme with WCF Data Services, see the blog post [OData and Authentication – Part 6 – Custom Basic Authentication](https://devblogs.microsoft.com/odata/odata-and-authentication-part-6-custom-basic-authentication/).</span></span>|  
|<span data-ttu-id="2f5c6-132">Windows 認証</span><span class="sxs-lookup"><span data-stu-id="2f5c6-132">Windows authentication</span></span>|<span data-ttu-id="2f5c6-133">Windows ベースの資格情報の交換には、NTLM または Kerberos が使用されます。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-133">Windows-based credentials are exchanged by using NTLM or Kerberos.</span></span> <span data-ttu-id="2f5c6-134">このメカニズムは基本認証やダイジェスト認証より安全ですが、クライアントが Windows ベースのアプリケーションである必要があります。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-134">This mechanism is more secure than basic or digest authentication, but it requires that the client be a Windows-based application.</span></span> <span data-ttu-id="2f5c6-135">IIS には、ASP.NET アプリケーションの HTTP 要求に対する Windows 認証の実装も用意されています。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-135">IIS also provides an implementation of Windows authentication for HTTP requests in an ASP.NET application.</span></span> <span data-ttu-id="2f5c6-136">詳細については、「 [ASP.NET フォーム認証の概要](/previous-versions/aspnet/7t6b43z4(v=vs.100))」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-136">For more information, see [ASP.NET Forms Authentication Overview](/previous-versions/aspnet/7t6b43z4(v=vs.100)).</span></span><br /><br /> <span data-ttu-id="2f5c6-137">WCF Data Services で Windows 認証スキームを使用する方法の例については、ブログ記事「[OData と認証の – パート 2 – Windows 認証](https://devblogs.microsoft.com/odata/odata-and-authentication-part-2-windows-authentication/)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-137">For an example of how to use Windows authentication with WCF Data Services, see the blog post [OData and Authentication – Part 2 – Windows Authentication](https://devblogs.microsoft.com/odata/odata-and-authentication-part-2-windows-authentication/).</span></span>|  
|<span data-ttu-id="2f5c6-138">ASP.NET フォーム認証</span><span class="sxs-lookup"><span data-stu-id="2f5c6-138">ASP.NET forms authentication</span></span>|<span data-ttu-id="2f5c6-139">フォーム認証では、独自のコードを使用してユーザーを認証し、認証トークンをクッキーまたはページ URL に保存できます。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-139">Forms authentication lets you authenticate users by using your own code and then maintain an authentication token in a cookie or in the page URL.</span></span> <span data-ttu-id="2f5c6-140">作成したログイン フォームを使用してユーザーのユーザー名とパスワードを認証します。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-140">You authenticate the user name and password of your users using a login form that you create.</span></span> <span data-ttu-id="2f5c6-141">認証されない要求はログイン ページにリダイレクトされ、ここでユーザーが資格情報を入力してフォームを送信します。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-141">Unauthenticated requests are redirected to a login page, where the user provides credentials and submits the form.</span></span> <span data-ttu-id="2f5c6-142">アプリケーションで要求を認証する場合、後続の要求で使用する ID を再確立するためのキーが含まれたチケットをシステムが発行します。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-142">If the application authenticates the request, the system issues a ticket that contains a key for reestablishing the identity for subsequent requests.</span></span> <span data-ttu-id="2f5c6-143">詳細については、「[フォーム認証プロバイダー](/previous-versions/aspnet/9wff0kyh(v=vs.100))」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-143">For more information, see [Forms Authentication Provider](/previous-versions/aspnet/9wff0kyh(v=vs.100)).</span></span> <span data-ttu-id="2f5c6-144">**セキュリティに関するメモ:** ASP.NET Web アプリケーションでフォーム認証を使用する場合、既定では、フォーム認証チケットを含むクッキーはセキュリティで保護されません。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-144">**Security Note:**  By default, the cookie that contains the forms authentication ticket is not secured when you use forms authentication in a ASP.NET Web application.</span></span> <span data-ttu-id="2f5c6-145">認証チケットと最初のログイン資格情報の両方を保護するには、SSL を要求することを検討してください。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-145">You should consider requiring SSL to protect both the authentication ticket and the initial login credentials.</span></span> <br /><br /> <span data-ttu-id="2f5c6-146">WCF Data Services でフォーム認証を使用する方法の例については、ブログ記事「[OData と認証の – パート 7 – フォーム認証](https://devblogs.microsoft.com/odata/odata-and-authentication-part-7-forms-authentication/)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-146">For an example of how to use forms authentication with WCF Data Services, see the blog post [OData and Authentication – Part 7 – Forms Authentication](https://devblogs.microsoft.com/odata/odata-and-authentication-part-7-forms-authentication/).</span></span>|  
|<span data-ttu-id="2f5c6-147">クレーム ベースの認証</span><span class="sxs-lookup"><span data-stu-id="2f5c6-147">Claims-based authentication</span></span>|<span data-ttu-id="2f5c6-148">クレーム ベースの認証では、データ サービスはユーザー認証を "サードパーティ" の信頼された ID プロバイダー サービスに依存します。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-148">In claims-based authentication, the data service relies on a trusted "third-party" identity provider service to authenticate the user.</span></span> <span data-ttu-id="2f5c6-149">ID プロバイダーは、データ サービス リソースへのアクセスを要求しているユーザーを確実に認証し、要求されたリソースへのアクセスを許可するトークンを発行します。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-149">The identity provider positively authenticates the user that is requesting access to data service resources and issues a token that grants access to the requested resources.</span></span> <span data-ttu-id="2f5c6-150">このトークンがデータ サービスに提示され、そのアクセス トークンを発行した識別情報サービスとの信頼関係に基づいてユーザーのアクセスが許可されます。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-150">This token is then presented to the data service, which then grants access to the user based on the trust relationship with the identity service that issued the access token.</span></span><br /><br /> <span data-ttu-id="2f5c6-151">クレーム ベースの認証プロバイダーの利点は、信頼ドメイン間でさまざまな種類のクライアントの認証に使用できることです。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-151">The benefit of using a claims-based authentication provider is that they can be used to authenticate various types of clients across trust domains.</span></span> <span data-ttu-id="2f5c6-152">このようなサードパーティ プロバイダーを使用することにより、ユーザーの管理と認証の要件をデータ サービスからオフロードできます。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-152">By employing such a third-party provider, a data service can offload the requirements of maintaining and authenticating users.</span></span> <span data-ttu-id="2f5c6-153">OAuth 2.0 は、サービスとしてのフェデレーション認証のために Azure AppFabric アクセス制御によってサポートされているクレーム ベースの認証プロトコルであり、</span><span class="sxs-lookup"><span data-stu-id="2f5c6-153">OAuth 2.0 is a claims-based authentication protocol that is supported by Azure AppFabric Access Control for federated authorization as a service.</span></span> <span data-ttu-id="2f5c6-154">REST ベースのサービスをサポートします。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-154">This protocol supports REST-based services.</span></span> <span data-ttu-id="2f5c6-155">WCF Data Services で OAuth 2.0 を使用する方法の例については、ブログ記事「[OData と認証の – パート 8 – OAuth WRAP](https://devblogs.microsoft.com/odata/odata-and-authentication-part-8-oauth-wrap/)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-155">For an example of how to use OAuth 2.0 with WCF Data Services, see the blog post [OData and Authentication – Part 8 – OAuth WRAP](https://devblogs.microsoft.com/odata/odata-and-authentication-part-8-oauth-wrap/).</span></span>|  
  
<a name="clientAuthentication"></a>

### <a name="authentication-in-the-client-library"></a><span data-ttu-id="2f5c6-156">クライアント ライブラリの認証</span><span class="sxs-lookup"><span data-stu-id="2f5c6-156">Authentication in the Client Library</span></span>  

 <span data-ttu-id="2f5c6-157">既定では、OData サービスに要求を送信する際、WCF Data Services クライアント ライブラリから資格情報は提供されません。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-157">By default, the WCF Data Services client library does not supply credentials when making a request to an OData service.</span></span> <span data-ttu-id="2f5c6-158">データ サービスでユーザー認証のためにログイン資格情報が要求されている場合は、<xref:System.Net.NetworkCredential> の <xref:System.Data.Services.Client.DataServiceContext.Credentials%2A> プロパティからアクセスできる <xref:System.Data.Services.Client.DataServiceContext> で資格情報を渡すことができます。以下に例を示します。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-158">When login credentials are required by the data service to authenticate a user, these credentials can be supplied in a <xref:System.Net.NetworkCredential> accessed from the <xref:System.Data.Services.Client.DataServiceContext.Credentials%2A> property of the <xref:System.Data.Services.Client.DataServiceContext>, as in the following example:</span></span>  
  
```csharp  
// Set the client authentication credentials.  
context.Credentials =  
    new NetworkCredential(userName, password, domain);  
```  
  
```vb  
' Set the client authentication credentials.  
context.Credentials = _  
    New NetworkCredential(userName, password, domain)  
```  
  
 <span data-ttu-id="2f5c6-159">詳細については、[データ サービス要求のクライアント資格情報の指定](specify-client-creds-for-a-data-service-request-wcf.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-159">For more information, see [How to: Specify Client Credentials for a Data Service Request](specify-client-creds-for-a-data-service-request-wcf.md).</span></span>  
  
 <span data-ttu-id="2f5c6-160">クレーム ベースのトークンやクッキーなど、<xref:System.Net.NetworkCredential> オブジェクトでは指定できないログイン資格情報がデータ サービスで要求されている場合は、手動で HTTP 要求のヘッダー (通常は `Authorization` と `Cookie`) を設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-160">When the data service requires login credentials that cannot be specified by using a <xref:System.Net.NetworkCredential> object, such as a claims-based token or cookie, you must manually set headers in the HTTP request, usually the `Authorization` and `Cookie` headers.</span></span> <span data-ttu-id="2f5c6-161">このような認証シナリオの詳細については、ブログ記事「[OData と認証の – パート 3 – クライアント側フック](https://devblogs.microsoft.com/odata/odata-and-authentication-part-3-clientside-hooks/)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-161">For more information about this kind of authentication scenario, see the blog post [ OData and Authentication – Part 3 – ClientSide Hooks](https://devblogs.microsoft.com/odata/odata-and-authentication-part-3-clientside-hooks/).</span></span> <span data-ttu-id="2f5c6-162">要求メッセージの HTTP ヘッダーを設定する方法の例については、「[方法: クライアント要求のヘッダーを設定する](how-to-set-headers-in-the-client-request-wcf-data-services.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-162">For an example of how to set HTTP headers in a request message, see [How to: Set Headers in the Client Request](how-to-set-headers-in-the-client-request-wcf-data-services.md).</span></span>  
  
## <a name="impersonation"></a><span data-ttu-id="2f5c6-163">偽装</span><span class="sxs-lookup"><span data-stu-id="2f5c6-163">Impersonation</span></span>  

 <span data-ttu-id="2f5c6-164">データ サービスは通常、データ サービスをホストしているワーカー プロセスの資格情報を使用して、要求されたリソース (サーバー上のファイル、データベースなど) にアクセスします。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-164">Generally, the data service accesses required resources, such as files on the server or a database, by using the credentials of the worker process that is hosting the data service.</span></span> <span data-ttu-id="2f5c6-165">偽装を使用しているときは、要求を出しているユーザーの Window ID (ユーザー アカウント) で ASP.NET アプリケーションを実行できます。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-165">When using impersonation, ASP.NET applications can execute with the Windows identity (user account) of the user making the request.</span></span> <span data-ttu-id="2f5c6-166">偽装は、IIS を使用してユーザーを認証するアプリケーションで使用されるのが一般的です。この場合、要求されたリソースへのアクセスにそのプリンシパルの資格情報が使用されます。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-166">Impersonation is commonly used in applications that rely on IIS to authenticate the user, and the credentials of this principle are used to access the required resources.</span></span> <span data-ttu-id="2f5c6-167">詳細については、「[ASP.NET の偽装](/previous-versions/aspnet/xh507fc5(v=vs.100))」参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-167">For more information, see [ASP.NET Impersonation](/previous-versions/aspnet/xh507fc5(v=vs.100)).</span></span>  
  
## <a name="configuring-data-service-authorization"></a><span data-ttu-id="2f5c6-168">データ サービスの承認の構成</span><span class="sxs-lookup"><span data-stu-id="2f5c6-168">Configuring Data Service Authorization</span></span>  

 <span data-ttu-id="2f5c6-169">承認とは、事前に行われた認証に基づいて識別されるプリンシパルまたはプロセスにアプリケーション リソースへのアクセスを許可することです。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-169">Authorization is the granting of access to application resources to a principle or process that is identified based on a previously successful authentication.</span></span> <span data-ttu-id="2f5c6-170">一般に、データ サービスのユーザーには、クライアント アプリケーションで必要とされている操作を実行するのに十分な権限のみを与えるようにします。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-170">As a general practice, you should only grant sufficient rights to users of the data service to perform the operations required by client applications.</span></span>  
  
### <a name="restrict-access-to-data-service-resources"></a><span data-ttu-id="2f5c6-171">データ サービス リソースへのアクセスの制限</span><span class="sxs-lookup"><span data-stu-id="2f5c6-171">Restrict Access to Data Service Resources</span></span>  

 <span data-ttu-id="2f5c6-172">WCF Data Services では、データ サービスにアクセスできるすべてのユーザーにデータ サービス リソース (エンティティ セットおよびサービス操作) に対する共通の読み取りおよび書き込みのアクセス権が既定で付与されます。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-172">By default, WCF Data Services enables you to grant common read and write access against data service resources (entity set and service operations) to any user that is able to access the data service.</span></span> <span data-ttu-id="2f5c6-173">読み取りおよび書き込みのアクセスを定義する規則は、データ サービスによって公開される各エンティティ セットおよびサービス操作に対して個別に定義できます。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-173">Rules that define read and write access can be defined separately for each entity set exposed by the data service, as well as to any service operations.</span></span> <span data-ttu-id="2f5c6-174">読み取りおよび書き込みの両方のアクセスを、クライアント アプリケーションで必要なリソースのみに制限することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-174">We recommend limiting both read and write access to only the resources required by the client application.</span></span> <span data-ttu-id="2f5c6-175">詳細については、「[最小限のリソース アクセス要件](configuring-the-data-service-wcf-data-services.md#accessRequirements)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-175">For more information, see [Minimum Resource Access Requirements](configuring-the-data-service-wcf-data-services.md#accessRequirements).</span></span>  
  
### <a name="implement-role-based-interceptors"></a><span data-ttu-id="2f5c6-176">ロール ベースのインターセプターの実装</span><span class="sxs-lookup"><span data-stu-id="2f5c6-176">Implement Role-Based Interceptors</span></span>  

 <span data-ttu-id="2f5c6-177">インターセプターを使用すると、データ サービス リソースに対する要求を、データ サービスによって処理される前にインターセプトすることができます。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-177">Interceptors enable you to intercept requests against data service resources before they are acted on by the data service.</span></span> <span data-ttu-id="2f5c6-178">詳細については、「[インターセプター](interceptors-wcf-data-services.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-178">For more information, see [Interceptors](interceptors-wcf-data-services.md).</span></span> <span data-ttu-id="2f5c6-179">インターセプターを使用すると、要求を行っている認証されたユーザーに基づいて承認決定を行うことができます。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-179">Interceptors enable you to make authorization decisions based the authenticated user that is making the request.</span></span> <span data-ttu-id="2f5c6-180">認証されたユーザーの ID に基づいてデータ サービス リソースへのアクセスを制限する方法の例については、「[方法: データ サービス メッセージを先に取得する](how-to-intercept-data-service-messages-wcf-data-services.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-180">For an example of how to restrict access to data service resources based on an authenticated user identity, see [How to: Intercept Data Service Messages](how-to-intercept-data-service-messages-wcf-data-services.md).</span></span>  
  
### <a name="restrict-access-to-the-persisted-data-store-and-local-resources"></a><span data-ttu-id="2f5c6-181">永続化データ ストアとローカル リソースへのアクセスの制限</span><span class="sxs-lookup"><span data-stu-id="2f5c6-181">Restrict Access to the Persisted Data Store and Local Resources</span></span>  

 <span data-ttu-id="2f5c6-182">永続化ストアにアクセスするためのアカウントには、データベースまたはファイル システムでデータ サービスの要件をサポートするのに十分な権限のみを与えるようにしてください。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-182">The accounts that are used to access the persisted store should be granted only enough rights in a database or the file system to support the requirements of the data service.</span></span> <span data-ttu-id="2f5c6-183">匿名認証が使用されている場合は、そのアカウントがホスト アプリケーションの実行に使用されます。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-183">When anonymous authentication is used, this is the account used to run the hosting application.</span></span> <span data-ttu-id="2f5c6-184">詳細については、[IIS 上で実行する WCF Data Service を開発する](how-to-develop-a-wcf-data-service-running-on-iis.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-184">For more information, see [How to: Develop a WCF Data Service Running on IIS](how-to-develop-a-wcf-data-service-running-on-iis.md).</span></span> <span data-ttu-id="2f5c6-185">偽装を使用する場合は、認証されたユーザーにそれらのリソースへのアクセスを (通常は Windows グループの一部として) 許可する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-185">When impersonation is used, authenticated users must be granted access to these resources, usually as part of a Windows group.</span></span>  
  
## <a name="other-security-considerations"></a><span data-ttu-id="2f5c6-186">その他のセキュリティの考慮事項</span><span class="sxs-lookup"><span data-stu-id="2f5c6-186">Other Security Considerations</span></span>  
  
### <a name="secure-the-data-in-the-payload"></a><span data-ttu-id="2f5c6-187">ペイロードのデータの保護</span><span class="sxs-lookup"><span data-stu-id="2f5c6-187">Secure the Data in the Payload</span></span>  

<span data-ttu-id="2f5c6-188">OData は HTTP プロトコルに基づいています。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-188">OData is based on the HTTP protocol.</span></span> <span data-ttu-id="2f5c6-189">データ サービスで実装されている認証によっては、HTTP メッセージのヘッダーに重要なユーザー資格情報が含まれている場合があります。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-189">In an HTTP message, the header may contain valuable user credentials, depending on the authentication implemented by the data service.</span></span> <span data-ttu-id="2f5c6-190">メッセージの本文にも、保護する必要がある貴重な顧客データが含まれている場合があります。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-190">The message body may also contain valuable customer data that must be protected.</span></span> <span data-ttu-id="2f5c6-191">いずれの場合も、SSL を使用してその情報をネットワークで保護することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-191">In both of these cases, we recommend that you use SSL to protect this information over the wire.</span></span>  
  
### <a name="ignored-message-headers-and-cookies"></a><span data-ttu-id="2f5c6-192">無視されるメッセージ ヘッダーとクッキー</span><span class="sxs-lookup"><span data-stu-id="2f5c6-192">Ignored Message Headers and Cookies</span></span>  

 <span data-ttu-id="2f5c6-193">HTTP 要求のヘッダーは、コンテンツ タイプとリソースの場所を宣言するもの以外は無視されます。また、データ サービスによって設定されることはありません。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-193">HTTP request headers, other than those that declare content types and resource locations, are ignored and are never set by the data service.</span></span>  
  
 <span data-ttu-id="2f5c6-194">Cookie は、認証方式の一部としては使用できます (ASP.NET フォーム認証など)。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-194">Cookies can be used as part of an authentication scheme, such as with ASP.NET Forms Authentication.</span></span> <span data-ttu-id="2f5c6-195">一方、受信要求で設定された HTTP Cookie は、WCF Data Service によって無視されます。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-195">However, any HTTP cookies set on an incoming request are ignored by WCF DataServices.</span></span> <span data-ttu-id="2f5c6-196">データ サービスのホストによって処理されることはありますが、WCF Data Services ランタイムによって分析されたり返されたりすることはありません。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-196">The host of a data service may process the cookie, but the WCF Data Services runtime never analyzes or returns cookies.</span></span> <span data-ttu-id="2f5c6-197">応答で送信された Cookie が WCF Data Services クライアント ライブラリで処理されることもありません。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-197">The WCF Data Services client library also does not process cookies sent in the response.</span></span>  
  
### <a name="custom-hosting-requirements"></a><span data-ttu-id="2f5c6-198">カスタム ホストの要件</span><span class="sxs-lookup"><span data-stu-id="2f5c6-198">Custom Hosting Requirements</span></span>  

 <span data-ttu-id="2f5c6-199">既定では、WCF Data Services は IIS でホストされる ASP.NET アプリケーションとして作成されます。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-199">By default, WCF Data Services is created as an ASP.NET application hosted in IIS.</span></span> <span data-ttu-id="2f5c6-200">そのため、データ サービスでこのプラットフォームのセキュリティ動作を活用できます。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-200">This enables the data service to leverage the secure behaviors of this platform.</span></span> <span data-ttu-id="2f5c6-201">カスタム ホストによってホストされる WCF Data Services を定義することもできます。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-201">You can define WCF Data Services that are hosted by a custom host.</span></span> <span data-ttu-id="2f5c6-202">詳細については、「[データ サービスのホスティング](hosting-the-data-service-wcf-data-services.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-202">For more information, see [Hosting the Data Service](hosting-the-data-service-wcf-data-services.md).</span></span> <span data-ttu-id="2f5c6-203">データ サービスをホストするコンポーネントとプラットフォームでは、データ サービスへの攻撃を防ぐために次のセキュリティ動作を確保する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-203">The components and platform hosting a data service must ensure the following security behaviors to prevent attacks on the data service:</span></span>  
  
- <span data-ttu-id="2f5c6-204">可能なすべての操作について、データ サービス要求で受け入れる URI の長さを制限します。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-204">Limit the length of the URI accepted in a data service request for all possible operations.</span></span>  
  
- <span data-ttu-id="2f5c6-205">着信および発信の両方の HTTP メッセージのサイズを制限します。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-205">Limit the size of both incoming and outgoing HTTP messages.</span></span>  
  
- <span data-ttu-id="2f5c6-206">任意の時点の未処理の要求の総数を制限します。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-206">Limit the total number of outstanding requests at any given time.</span></span>  
  
- <span data-ttu-id="2f5c6-207">HTTP ヘッダーとその値のサイズを制限し、WCF Data Services でヘッダーのデータにアクセスできるようにします。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-207">Limit the size of HTTP headers and their values, and provide WCF Data Services access to header data.</span></span>  
  
- <span data-ttu-id="2f5c6-208">TCP SYN 攻撃やメッセージ リプレイ攻撃などの既知の攻撃を検出して阻止します。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-208">Detect and counter known attacks, such as TCP SYN and message replay attacks.</span></span>  
  
### <a name="values-are-not-further-encoded"></a><span data-ttu-id="2f5c6-209">値のさらなるエンコード</span><span class="sxs-lookup"><span data-stu-id="2f5c6-209">Values Are Not Further Encoded</span></span>  

 <span data-ttu-id="2f5c6-210">データ サービスに送信されたプロパティ値が WCF Data Services ランタイムによってさらにエンコードされることはありません。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-210">Property values sent to the data service are not further encoded by the WCF Data Services runtime.</span></span> <span data-ttu-id="2f5c6-211">たとえば、書式設定された HTML コンテンツがエンティティの文字列プロパティに含まれていた場合、データ サービスによってタグが HTML エンコードされることはありません。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-211">For example, when a string property of an entity contains formatted HTML content, the tags are not HTML encoded by the data service.</span></span> <span data-ttu-id="2f5c6-212">応答のプロパティ値についても、データ サービスによってさらなるエンコードが行われることはありません。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-212">The data service also does not further encode property values in the response.</span></span> <span data-ttu-id="2f5c6-213">クライアント ライブラリで追加のエンコードが行われることもありません。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-213">The client library also does not perform any additional encoding.</span></span>  
  
### <a name="considerations-for-client-applications"></a><span data-ttu-id="2f5c6-214">クライアント アプリケーションに関する注意点</span><span class="sxs-lookup"><span data-stu-id="2f5c6-214">Considerations for Client Applications</span></span>  

 <span data-ttu-id="2f5c6-215">以下のセキュリティの注意点は、WCF Data Services クライアントを使用して OData サービスにアクセスするアプリケーションに当てはまります。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-215">The following security considerations apply to applications that use the WCF Data Services client to access OData services:</span></span>  
  
- <span data-ttu-id="2f5c6-216">クライアント ライブラリは、データ サービスへのアクセスに使用されるプロトコルで十分なレベルのセキュリティが確保されていることを前提としています。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-216">The client library assumes that the protocols used to access the data service provide an appropriate level of security.</span></span>  
  
- <span data-ttu-id="2f5c6-217">クライアント ライブラリは、基になるプラットフォームによって提供されるトランスポート スタックのタイムアウトや解析のすべてのオプションに対して既定値を使用します。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-217">The client library uses all the default values for timeouts and parsing options of the underlying platform-provided transport stacks.</span></span>  
  
- <span data-ttu-id="2f5c6-218">クライアント ライブラリはアプリケーション構成ファイルの設定を読み取りません。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-218">The client library does not read any settings from application configuration files.</span></span>  
  
- <span data-ttu-id="2f5c6-219">クライアント ライブラリにはドメイン間アクセスのメカニズムは実装されていません。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-219">The client library does not implement any cross domain access mechanisms.</span></span> <span data-ttu-id="2f5c6-220">基になる HTTP スタックによって提供されるメカニズムが使用されます。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-220">Instead, it relies on the mechanisms provided by the underlying HTTP stack.</span></span>  
  
- <span data-ttu-id="2f5c6-221">クライアント ライブラリにはユーザー インターフェイス要素はありません。送受信されるデータの表示は行われません。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-221">The client library has no user interface elements, and it never tries to display or render the data that it receives or sends.</span></span>  
  
- <span data-ttu-id="2f5c6-222">クライアント アプリケーションで常にユーザー入力と信頼されていないサービスからのデータを検証することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="2f5c6-222">We recommend that client applications always validate user input as well as data accepted from untrusted services.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2f5c6-223">関連項目</span><span class="sxs-lookup"><span data-stu-id="2f5c6-223">See also</span></span>

- [<span data-ttu-id="2f5c6-224">WCF Data Services の定義</span><span class="sxs-lookup"><span data-stu-id="2f5c6-224">Defining WCF Data Services</span></span>](defining-wcf-data-services.md)
- [<span data-ttu-id="2f5c6-225">WCF Data Services クライアント ライブラリ</span><span class="sxs-lookup"><span data-stu-id="2f5c6-225">WCF Data Services Client Library</span></span>](wcf-data-services-client-library.md)
